<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 S3 | Advanced R</title>
  <meta name="description" content="13 S3 | Advanced R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="13 S3 | Advanced R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 S3 | Advanced R" />
  
  
  

<meta name="author" content="Hadley Wickham" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="base-types.html"/>
<link rel="next" href="r6.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141212623-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-141212623-1');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="adv-r.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Advanced R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-books"><i class="fa fa-check"></i>Other books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#who-should-read"><i class="fa fa-check"></i><b>1.2</b> Who should read this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-you-will-get"><i class="fa fa-check"></i><b>1.3</b> What you will get out of this book</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-you-will-not-learn"><i class="fa fa-check"></i><b>1.4</b> What you will not learn</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#meta-techniques"><i class="fa fa-check"></i><b>1.5</b> Meta-techniques</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#recommended-reading"><i class="fa fa-check"></i><b>1.6</b> Recommended reading</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>1.7</b> Getting help</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#intro-ack"><i class="fa fa-check"></i><b>1.8</b> Acknowledgments</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#conventions"><i class="fa fa-check"></i><b>1.9</b> Conventions</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.10</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="" data-path="foundations-intro.html"><a href="foundations-intro.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2" data-path="names-values.html"><a href="names-values.html"><i class="fa fa-check"></i><b>2</b> Names and values</a>
<ul>
<li class="chapter" data-level="2.1" data-path="names-values.html"><a href="names-values.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#sources"><i class="fa fa-check"></i>Sources</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="names-values.html"><a href="names-values.html#binding-basics"><i class="fa fa-check"></i><b>2.2</b> Binding basics</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="names-values.html"><a href="names-values.html#non-syntactic"><i class="fa fa-check"></i><b>2.2.1</b> Non-syntactic names</a></li>
<li class="chapter" data-level="2.2.2" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>2.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="names-values.html"><a href="names-values.html#copy-on-modify"><i class="fa fa-check"></i><b>2.3</b> Copy-on-modify</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="names-values.html"><a href="names-values.html#tracemem"><i class="fa fa-check"></i><b>2.3.1</b> <code>tracemem()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="names-values.html"><a href="names-values.html#function-calls"><i class="fa fa-check"></i><b>2.3.2</b> Function calls</a></li>
<li class="chapter" data-level="2.3.3" data-path="names-values.html"><a href="names-values.html#list-references"><i class="fa fa-check"></i><b>2.3.3</b> Lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="names-values.html"><a href="names-values.html#df-modify"><i class="fa fa-check"></i><b>2.3.4</b> Data frames</a></li>
<li class="chapter" data-level="2.3.5" data-path="names-values.html"><a href="names-values.html#character-vectors"><i class="fa fa-check"></i><b>2.3.5</b> Character vectors</a></li>
<li class="chapter" data-level="2.3.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>2.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="names-values.html"><a href="names-values.html#object-size"><i class="fa fa-check"></i><b>2.4</b> Object size</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="names-values.html"><a href="names-values.html#modify-in-place"><i class="fa fa-check"></i><b>2.5</b> Modify-in-place</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="names-values.html"><a href="names-values.html#single-binding"><i class="fa fa-check"></i><b>2.5.1</b> Objects with a single binding</a></li>
<li class="chapter" data-level="2.5.2" data-path="names-values.html"><a href="names-values.html#env-modify"><i class="fa fa-check"></i><b>2.5.2</b> Environments</a></li>
<li class="chapter" data-level="2.5.3" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>2.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="names-values.html"><a href="names-values.html#gc"><i class="fa fa-check"></i><b>2.6</b> Unbinding and the garbage collector</a></li>
<li class="chapter" data-level="2.7" data-path="names-values.html"><a href="names-values.html#names-values-answers"><i class="fa fa-check"></i><b>2.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vectors-chap.html"><a href="vectors-chap.html"><i class="fa fa-check"></i><b>3</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="vectors-chap.html"><a href="vectors-chap.html#quiz-1"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="vectors-chap.html"><a href="vectors-chap.html#outline-1"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-vectors"><i class="fa fa-check"></i><b>3.2</b> Atomic vectors</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="vectors-chap.html"><a href="vectors-chap.html#scalars"><i class="fa fa-check"></i><b>3.2.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-constructing"><i class="fa fa-check"></i><b>3.2.2</b> Making longer vectors with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="vectors-chap.html"><a href="vectors-chap.html#missing-values"><i class="fa fa-check"></i><b>3.2.3</b> Missing values</a></li>
<li class="chapter" data-level="3.2.4" data-path="vectors-chap.html"><a href="vectors-chap.html#testing-and-coercion"><i class="fa fa-check"></i><b>3.2.4</b> Testing and coercion</a></li>
<li class="chapter" data-level="3.2.5" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>3.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attributes"><i class="fa fa-check"></i><b>3.3</b> Attributes</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#getting-and-setting"><i class="fa fa-check"></i><b>3.3.1</b> Getting and setting</a></li>
<li class="chapter" data-level="3.3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-names"><i class="fa fa-check"></i><b>3.3.2</b> Names</a></li>
<li class="chapter" data-level="3.3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-dims"><i class="fa fa-check"></i><b>3.3.3</b> Dimensions</a></li>
<li class="chapter" data-level="3.3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-5"><i class="fa fa-check"></i><b>3.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#s3-atomic-vectors"><i class="fa fa-check"></i><b>3.4</b> S3 atomic vectors</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="vectors-chap.html"><a href="vectors-chap.html#factors"><i class="fa fa-check"></i><b>3.4.1</b> Factors</a></li>
<li class="chapter" data-level="3.4.2" data-path="vectors-chap.html"><a href="vectors-chap.html#dates"><i class="fa fa-check"></i><b>3.4.2</b> Dates</a></li>
<li class="chapter" data-level="3.4.3" data-path="vectors-chap.html"><a href="vectors-chap.html#date-times"><i class="fa fa-check"></i><b>3.4.3</b> Date-times</a></li>
<li class="chapter" data-level="3.4.4" data-path="vectors-chap.html"><a href="vectors-chap.html#durations"><i class="fa fa-check"></i><b>3.4.4</b> Durations</a></li>
<li class="chapter" data-level="3.4.5" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-6"><i class="fa fa-check"></i><b>3.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="vectors-chap.html"><a href="vectors-chap.html#lists"><i class="fa fa-check"></i><b>3.5</b> Lists</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="vectors-chap.html"><a href="vectors-chap.html#list-creating"><i class="fa fa-check"></i><b>3.5.1</b> Creating</a></li>
<li class="chapter" data-level="3.5.2" data-path="vectors-chap.html"><a href="vectors-chap.html#list-types"><i class="fa fa-check"></i><b>3.5.2</b> Testing and coercion</a></li>
<li class="chapter" data-level="3.5.3" data-path="vectors-chap.html"><a href="vectors-chap.html#list-array"><i class="fa fa-check"></i><b>3.5.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.5.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-7"><i class="fa fa-check"></i><b>3.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="vectors-chap.html"><a href="vectors-chap.html#tibble"><i class="fa fa-check"></i><b>3.6</b> Data frames and tibbles</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="vectors-chap.html"><a href="vectors-chap.html#df-create"><i class="fa fa-check"></i><b>3.6.1</b> Creating</a></li>
<li class="chapter" data-level="3.6.2" data-path="vectors-chap.html"><a href="vectors-chap.html#rownames"><i class="fa fa-check"></i><b>3.6.2</b> Row names</a></li>
<li class="chapter" data-level="3.6.3" data-path="vectors-chap.html"><a href="vectors-chap.html#printing"><i class="fa fa-check"></i><b>3.6.3</b> Printing</a></li>
<li class="chapter" data-level="3.6.4" data-path="vectors-chap.html"><a href="vectors-chap.html#safe-subsetting"><i class="fa fa-check"></i><b>3.6.4</b> Subsetting</a></li>
<li class="chapter" data-level="3.6.5" data-path="vectors-chap.html"><a href="vectors-chap.html#df-test-coerce"><i class="fa fa-check"></i><b>3.6.5</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.6.6" data-path="vectors-chap.html"><a href="vectors-chap.html#list-columns"><i class="fa fa-check"></i><b>3.6.6</b> List columns</a></li>
<li class="chapter" data-level="3.6.7" data-path="vectors-chap.html"><a href="vectors-chap.html#matrix-and-data-frame-columns"><i class="fa fa-check"></i><b>3.6.7</b> Matrix and data frame columns</a></li>
<li class="chapter" data-level="3.6.8" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-8"><i class="fa fa-check"></i><b>3.6.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="vectors-chap.html"><a href="vectors-chap.html#null"><i class="fa fa-check"></i><b>3.7</b> <code>NULL</code></a></li>
<li class="chapter" data-level="3.8" data-path="vectors-chap.html"><a href="vectors-chap.html#data-structure-answers"><i class="fa fa-check"></i><b>3.8</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="subsetting.html"><a href="subsetting.html"><i class="fa fa-check"></i><b>4</b> Subsetting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="subsetting.html"><a href="subsetting.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#quiz-2"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#outline-2"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="subsetting.html"><a href="subsetting.html#subset-multiple"><i class="fa fa-check"></i><b>4.2</b> Selecting multiple elements</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="subsetting.html"><a href="subsetting.html#atomic-vectors-1"><i class="fa fa-check"></i><b>4.2.1</b> Atomic vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="subsetting.html"><a href="subsetting.html#lists-1"><i class="fa fa-check"></i><b>4.2.2</b> Lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="subsetting.html"><a href="subsetting.html#matrix-subsetting"><i class="fa fa-check"></i><b>4.2.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="4.2.4" data-path="subsetting.html"><a href="subsetting.html#df-subsetting"><i class="fa fa-check"></i><b>4.2.4</b> Data frames and tibbles</a></li>
<li class="chapter" data-level="4.2.5" data-path="subsetting.html"><a href="subsetting.html#simplify-preserve"><i class="fa fa-check"></i><b>4.2.5</b> Preserving dimensionality</a></li>
<li class="chapter" data-level="4.2.6" data-path="subsetting.html"><a href="subsetting.html#exercises-9"><i class="fa fa-check"></i><b>4.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="subsetting.html"><a href="subsetting.html#subset-single"><i class="fa fa-check"></i><b>4.3</b> Selecting a single element</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="subsetting.html"><a href="subsetting.html#section"><i class="fa fa-check"></i><b>4.3.1</b> <code>[[</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="subsetting.html"><a href="subsetting.html#section-1"><i class="fa fa-check"></i><b>4.3.2</b> <code>$</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="subsetting.html"><a href="subsetting.html#subsetting-oob"><i class="fa fa-check"></i><b>4.3.3</b> Missing and out-of-bounds indices</a></li>
<li class="chapter" data-level="4.3.4" data-path="subsetting.html"><a href="subsetting.html#and-slot"><i class="fa fa-check"></i><b>4.3.4</b> <code>@</code> and <code>slot()</code></a></li>
<li class="chapter" data-level="4.3.5" data-path="subsetting.html"><a href="subsetting.html#exercises-10"><i class="fa fa-check"></i><b>4.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="subsetting.html"><a href="subsetting.html#subassignment"><i class="fa fa-check"></i><b>4.4</b> Subsetting and assignment</a></li>
<li class="chapter" data-level="4.5" data-path="subsetting.html"><a href="subsetting.html#applications"><i class="fa fa-check"></i><b>4.5</b> Applications</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="subsetting.html"><a href="subsetting.html#lookup-tables"><i class="fa fa-check"></i><b>4.5.1</b> Lookup tables (character subsetting)</a></li>
<li class="chapter" data-level="4.5.2" data-path="subsetting.html"><a href="subsetting.html#matching-merging"><i class="fa fa-check"></i><b>4.5.2</b> Matching and merging by hand (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.3" data-path="subsetting.html"><a href="subsetting.html#random-samples-and-bootstraps-integer-subsetting"><i class="fa fa-check"></i><b>4.5.3</b> Random samples and bootstraps (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.4" data-path="subsetting.html"><a href="subsetting.html#ordering-integer-subsetting"><i class="fa fa-check"></i><b>4.5.4</b> Ordering (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.5" data-path="subsetting.html"><a href="subsetting.html#expanding-aggregated-counts-integer-subsetting"><i class="fa fa-check"></i><b>4.5.5</b> Expanding aggregated counts (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.6" data-path="subsetting.html"><a href="subsetting.html#removing-columns-from-data-frames-character"><i class="fa fa-check"></i><b>4.5.6</b> Removing columns from data frames (character )</a></li>
<li class="chapter" data-level="4.5.7" data-path="subsetting.html"><a href="subsetting.html#selecting-rows-based-on-a-condition-logical-subsetting"><i class="fa fa-check"></i><b>4.5.7</b> Selecting rows based on a condition (logical subsetting)</a></li>
<li class="chapter" data-level="4.5.8" data-path="subsetting.html"><a href="subsetting.html#boolean-algebra-versus-sets-logical-and-integer"><i class="fa fa-check"></i><b>4.5.8</b> Boolean algebra versus sets (logical and integer )</a></li>
<li class="chapter" data-level="4.5.9" data-path="subsetting.html"><a href="subsetting.html#exercises-11"><i class="fa fa-check"></i><b>4.5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="subsetting.html"><a href="subsetting.html#subsetting-answers"><i class="fa fa-check"></i><b>4.6</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>5</b> Control flow</a>
<ul>
<li class="chapter" data-level="5.1" data-path="control-flow.html"><a href="control-flow.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#quiz-3"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="control-flow.html"><a href="control-flow.html#outline-3"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="control-flow.html"><a href="control-flow.html#choices"><i class="fa fa-check"></i><b>5.2</b> Choices</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="control-flow.html"><a href="control-flow.html#invalid-inputs"><i class="fa fa-check"></i><b>5.2.1</b> Invalid inputs</a></li>
<li class="chapter" data-level="5.2.2" data-path="control-flow.html"><a href="control-flow.html#vectorised-if"><i class="fa fa-check"></i><b>5.2.2</b> Vectorised if</a></li>
<li class="chapter" data-level="5.2.3" data-path="control-flow.html"><a href="control-flow.html#switch"><i class="fa fa-check"></i><b>5.2.3</b> <code>switch()</code> statement</a></li>
<li class="chapter" data-level="5.2.4" data-path="control-flow.html"><a href="control-flow.html#exercises-12"><i class="fa fa-check"></i><b>5.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="control-flow.html"><a href="control-flow.html#loops"><i class="fa fa-check"></i><b>5.3</b> Loops</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="control-flow.html"><a href="control-flow.html#common-pitfalls"><i class="fa fa-check"></i><b>5.3.1</b> Common pitfalls</a></li>
<li class="chapter" data-level="5.3.2" data-path="control-flow.html"><a href="control-flow.html#for-family"><i class="fa fa-check"></i><b>5.3.2</b> Related tools</a></li>
<li class="chapter" data-level="5.3.3" data-path="control-flow.html"><a href="control-flow.html#exercises-13"><i class="fa fa-check"></i><b>5.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="control-flow.html"><a href="control-flow.html#control-flow-answers"><i class="fa fa-check"></i><b>5.4</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="functions.html"><a href="functions.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#quiz-4"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#outline-4"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#function-fundamentals"><i class="fa fa-check"></i><b>6.2</b> Function fundamentals</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="functions.html"><a href="functions.html#fun-components"><i class="fa fa-check"></i><b>6.2.1</b> Function components</a></li>
<li class="chapter" data-level="6.2.2" data-path="functions.html"><a href="functions.html#primitive-functions"><i class="fa fa-check"></i><b>6.2.2</b> Primitive functions</a></li>
<li class="chapter" data-level="6.2.3" data-path="functions.html"><a href="functions.html#first-class-functions"><i class="fa fa-check"></i><b>6.2.3</b> First-class functions</a></li>
<li class="chapter" data-level="6.2.4" data-path="functions.html"><a href="functions.html#invoking-a-function"><i class="fa fa-check"></i><b>6.2.4</b> Invoking a function</a></li>
<li class="chapter" data-level="6.2.5" data-path="functions.html"><a href="functions.html#exercises-14"><i class="fa fa-check"></i><b>6.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#function-composition"><i class="fa fa-check"></i><b>6.3</b> Function composition</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#lexical-scoping"><i class="fa fa-check"></i><b>6.4</b> Lexical scoping</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="functions.html"><a href="functions.html#name-masking"><i class="fa fa-check"></i><b>6.4.1</b> Name masking</a></li>
<li class="chapter" data-level="6.4.2" data-path="functions.html"><a href="functions.html#functions-versus-variables"><i class="fa fa-check"></i><b>6.4.2</b> Functions versus variables</a></li>
<li class="chapter" data-level="6.4.3" data-path="functions.html"><a href="functions.html#fresh-start"><i class="fa fa-check"></i><b>6.4.3</b> A fresh start</a></li>
<li class="chapter" data-level="6.4.4" data-path="functions.html"><a href="functions.html#dynamic-lookup"><i class="fa fa-check"></i><b>6.4.4</b> Dynamic lookup</a></li>
<li class="chapter" data-level="6.4.5" data-path="functions.html"><a href="functions.html#exercises-15"><i class="fa fa-check"></i><b>6.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="functions.html"><a href="functions.html#lazy-evaluation"><i class="fa fa-check"></i><b>6.5</b> Lazy evaluation</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="functions.html"><a href="functions.html#promises"><i class="fa fa-check"></i><b>6.5.1</b> Promises</a></li>
<li class="chapter" data-level="6.5.2" data-path="functions.html"><a href="functions.html#default-arguments"><i class="fa fa-check"></i><b>6.5.2</b> Default arguments</a></li>
<li class="chapter" data-level="6.5.3" data-path="functions.html"><a href="functions.html#missing-arguments"><i class="fa fa-check"></i><b>6.5.3</b> Missing arguments</a></li>
<li class="chapter" data-level="6.5.4" data-path="functions.html"><a href="functions.html#exercises-16"><i class="fa fa-check"></i><b>6.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="functions.html"><a href="functions.html#fun-dot-dot-dot"><i class="fa fa-check"></i><b>6.6</b> <code>...</code> (dot-dot-dot)</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="functions.html"><a href="functions.html#exercises-17"><i class="fa fa-check"></i><b>6.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="functions.html"><a href="functions.html#exiting-a-function"><i class="fa fa-check"></i><b>6.7</b> Exiting a function</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="functions.html"><a href="functions.html#implicit-versus-explicit-returns"><i class="fa fa-check"></i><b>6.7.1</b> Implicit versus explicit returns</a></li>
<li class="chapter" data-level="6.7.2" data-path="functions.html"><a href="functions.html#invisible"><i class="fa fa-check"></i><b>6.7.2</b> Invisible values</a></li>
<li class="chapter" data-level="6.7.3" data-path="functions.html"><a href="functions.html#errors"><i class="fa fa-check"></i><b>6.7.3</b> Errors</a></li>
<li class="chapter" data-level="6.7.4" data-path="functions.html"><a href="functions.html#on-exit"><i class="fa fa-check"></i><b>6.7.4</b> Exit handlers</a></li>
<li class="chapter" data-level="6.7.5" data-path="functions.html"><a href="functions.html#exercises-18"><i class="fa fa-check"></i><b>6.7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="functions.html"><a href="functions.html#function-forms"><i class="fa fa-check"></i><b>6.8</b> Function forms</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="functions.html"><a href="functions.html#prefix-transform"><i class="fa fa-check"></i><b>6.8.1</b> Rewriting to prefix form</a></li>
<li class="chapter" data-level="6.8.2" data-path="functions.html"><a href="functions.html#prefix-form"><i class="fa fa-check"></i><b>6.8.2</b> Prefix form</a></li>
<li class="chapter" data-level="6.8.3" data-path="functions.html"><a href="functions.html#infix-functions"><i class="fa fa-check"></i><b>6.8.3</b> Infix functions</a></li>
<li class="chapter" data-level="6.8.4" data-path="functions.html"><a href="functions.html#replacement-functions"><i class="fa fa-check"></i><b>6.8.4</b> Replacement functions</a></li>
<li class="chapter" data-level="6.8.5" data-path="functions.html"><a href="functions.html#special-forms"><i class="fa fa-check"></i><b>6.8.5</b> Special forms</a></li>
<li class="chapter" data-level="6.8.6" data-path="functions.html"><a href="functions.html#exercises-19"><i class="fa fa-check"></i><b>6.8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="functions.html"><a href="functions.html#function-answers"><i class="fa fa-check"></i><b>6.9</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="environments.html"><a href="environments.html"><i class="fa fa-check"></i><b>7</b> Environments</a>
<ul>
<li class="chapter" data-level="7.1" data-path="environments.html"><a href="environments.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#quiz-5"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#outline-5"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="environments.html"><a href="environments.html#env-basics"><i class="fa fa-check"></i><b>7.2</b> Environment basics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="environments.html"><a href="environments.html#basics"><i class="fa fa-check"></i><b>7.2.1</b> Basics</a></li>
<li class="chapter" data-level="7.2.2" data-path="environments.html"><a href="environments.html#important-environments"><i class="fa fa-check"></i><b>7.2.2</b> Important environments</a></li>
<li class="chapter" data-level="7.2.3" data-path="environments.html"><a href="environments.html#parents"><i class="fa fa-check"></i><b>7.2.3</b> Parents</a></li>
<li class="chapter" data-level="7.2.4" data-path="environments.html"><a href="environments.html#super-assignment--"><i class="fa fa-check"></i><b>7.2.4</b> Super assignment, <code>&lt;&lt;-</code></a></li>
<li class="chapter" data-level="7.2.5" data-path="environments.html"><a href="environments.html#getting-and-setting-1"><i class="fa fa-check"></i><b>7.2.5</b> Getting and setting</a></li>
<li class="chapter" data-level="7.2.6" data-path="environments.html"><a href="environments.html#advanced-bindings"><i class="fa fa-check"></i><b>7.2.6</b> Advanced bindings</a></li>
<li class="chapter" data-level="7.2.7" data-path="environments.html"><a href="environments.html#exercises-20"><i class="fa fa-check"></i><b>7.2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="environments.html"><a href="environments.html#env-recursion"><i class="fa fa-check"></i><b>7.3</b> Recursing over environments</a>
<ul>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#iteration-versus-recursion"><i class="fa fa-check"></i>Iteration versus recursion</a></li>
<li class="chapter" data-level="7.3.1" data-path="environments.html"><a href="environments.html#exercises-21"><i class="fa fa-check"></i><b>7.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="environments.html"><a href="environments.html#special-environments"><i class="fa fa-check"></i><b>7.4</b> Special environments</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="environments.html"><a href="environments.html#search-path"><i class="fa fa-check"></i><b>7.4.1</b> Package environments and the search path</a></li>
<li class="chapter" data-level="7.4.2" data-path="environments.html"><a href="environments.html#function-environments"><i class="fa fa-check"></i><b>7.4.2</b> The function environment</a></li>
<li class="chapter" data-level="7.4.3" data-path="environments.html"><a href="environments.html#namespaces"><i class="fa fa-check"></i><b>7.4.3</b> Namespaces</a></li>
<li class="chapter" data-level="7.4.4" data-path="environments.html"><a href="environments.html#execution-environments"><i class="fa fa-check"></i><b>7.4.4</b> Execution environments</a></li>
<li class="chapter" data-level="7.4.5" data-path="environments.html"><a href="environments.html#exercises-22"><i class="fa fa-check"></i><b>7.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="environments.html"><a href="environments.html#call-stack"><i class="fa fa-check"></i><b>7.5</b> Call stacks</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="environments.html"><a href="environments.html#simple-stack"><i class="fa fa-check"></i><b>7.5.1</b> Simple call stacks</a></li>
<li class="chapter" data-level="7.5.2" data-path="environments.html"><a href="environments.html#lazy-call-stack"><i class="fa fa-check"></i><b>7.5.2</b> Lazy evaluation</a></li>
<li class="chapter" data-level="7.5.3" data-path="environments.html"><a href="environments.html#frames"><i class="fa fa-check"></i><b>7.5.3</b> Frames</a></li>
<li class="chapter" data-level="7.5.4" data-path="environments.html"><a href="environments.html#dynamic-scope"><i class="fa fa-check"></i><b>7.5.4</b> Dynamic scope</a></li>
<li class="chapter" data-level="7.5.5" data-path="environments.html"><a href="environments.html#exercises-23"><i class="fa fa-check"></i><b>7.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="environments.html"><a href="environments.html#explicit-envs"><i class="fa fa-check"></i><b>7.6</b> As data structures</a></li>
<li class="chapter" data-level="7.7" data-path="environments.html"><a href="environments.html#env-answers"><i class="fa fa-check"></i><b>7.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditions.html"><a href="conditions.html"><i class="fa fa-check"></i><b>8</b> Conditions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditions.html"><a href="conditions.html#introduction-7"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="conditions.html"><a href="conditions.html#quiz-6"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="conditions.html"><a href="conditions.html#outline-6"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="8.1.1" data-path="conditions.html"><a href="conditions.html#prerequisites-2"><i class="fa fa-check"></i><b>8.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditions.html"><a href="conditions.html#signalling-conditions"><i class="fa fa-check"></i><b>8.2</b> Signalling conditions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="conditions.html"><a href="conditions.html#errors-1"><i class="fa fa-check"></i><b>8.2.1</b> Errors</a></li>
<li class="chapter" data-level="8.2.2" data-path="conditions.html"><a href="conditions.html#warnings"><i class="fa fa-check"></i><b>8.2.2</b> Warnings</a></li>
<li class="chapter" data-level="8.2.3" data-path="conditions.html"><a href="conditions.html#messages"><i class="fa fa-check"></i><b>8.2.3</b> Messages</a></li>
<li class="chapter" data-level="8.2.4" data-path="conditions.html"><a href="conditions.html#exercises-24"><i class="fa fa-check"></i><b>8.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="conditions.html"><a href="conditions.html#ignoring-conditions"><i class="fa fa-check"></i><b>8.3</b> Ignoring conditions</a></li>
<li class="chapter" data-level="8.4" data-path="conditions.html"><a href="conditions.html#handling-conditions"><i class="fa fa-check"></i><b>8.4</b> Handling conditions</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="conditions.html"><a href="conditions.html#condition-objects"><i class="fa fa-check"></i><b>8.4.1</b> Condition objects</a></li>
<li class="chapter" data-level="8.4.2" data-path="conditions.html"><a href="conditions.html#exiting-handlers"><i class="fa fa-check"></i><b>8.4.2</b> Exiting handlers</a></li>
<li class="chapter" data-level="8.4.3" data-path="conditions.html"><a href="conditions.html#calling-handlers"><i class="fa fa-check"></i><b>8.4.3</b> Calling handlers</a></li>
<li class="chapter" data-level="8.4.4" data-path="conditions.html"><a href="conditions.html#call-stacks"><i class="fa fa-check"></i><b>8.4.4</b> Call stacks</a></li>
<li class="chapter" data-level="8.4.5" data-path="conditions.html"><a href="conditions.html#exercises-25"><i class="fa fa-check"></i><b>8.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="conditions.html"><a href="conditions.html#custom-conditions"><i class="fa fa-check"></i><b>8.5</b> Custom conditions</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="conditions.html"><a href="conditions.html#motivation"><i class="fa fa-check"></i><b>8.5.1</b> Motivation</a></li>
<li class="chapter" data-level="8.5.2" data-path="conditions.html"><a href="conditions.html#signalling"><i class="fa fa-check"></i><b>8.5.2</b> Signalling</a></li>
<li class="chapter" data-level="8.5.3" data-path="conditions.html"><a href="conditions.html#handling"><i class="fa fa-check"></i><b>8.5.3</b> Handling</a></li>
<li class="chapter" data-level="8.5.4" data-path="conditions.html"><a href="conditions.html#exercises-26"><i class="fa fa-check"></i><b>8.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="conditions.html"><a href="conditions.html#condition-applications"><i class="fa fa-check"></i><b>8.6</b> Applications</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="conditions.html"><a href="conditions.html#failure-value"><i class="fa fa-check"></i><b>8.6.1</b> Failure value</a></li>
<li class="chapter" data-level="8.6.2" data-path="conditions.html"><a href="conditions.html#try-success-failure"><i class="fa fa-check"></i><b>8.6.2</b> Success and failure values</a></li>
<li class="chapter" data-level="8.6.3" data-path="conditions.html"><a href="conditions.html#resignal"><i class="fa fa-check"></i><b>8.6.3</b> Resignal</a></li>
<li class="chapter" data-level="8.6.4" data-path="conditions.html"><a href="conditions.html#record"><i class="fa fa-check"></i><b>8.6.4</b> Record</a></li>
<li class="chapter" data-level="8.6.5" data-path="conditions.html"><a href="conditions.html#no-default-behaviour"><i class="fa fa-check"></i><b>8.6.5</b> No default behaviour</a></li>
<li class="chapter" data-level="8.6.6" data-path="conditions.html"><a href="conditions.html#exercises-27"><i class="fa fa-check"></i><b>8.6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="conditions.html"><a href="conditions.html#conditions-answers"><i class="fa fa-check"></i><b>8.7</b> Quiz answers</a></li>
</ul></li>
<li class="part"><span><b>II Functional programming</b></span></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-programming-languages"><i class="fa fa-check"></i>Functional programming languages</a></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-style"><i class="fa fa-check"></i>Functional style</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functionals.html"><a href="functionals.html"><i class="fa fa-check"></i><b>9</b> Functionals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="functionals.html"><a href="functionals.html#introduction-8"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="functionals.html"><a href="functionals.html#outline-7"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="functionals.html"><a href="functionals.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="functionals.html"><a href="functionals.html#map"><i class="fa fa-check"></i><b>9.2</b> My first functional: <code>map()</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="functionals.html"><a href="functionals.html#map-atomic"><i class="fa fa-check"></i><b>9.2.1</b> Producing atomic vectors</a></li>
<li class="chapter" data-level="9.2.2" data-path="functionals.html"><a href="functionals.html#purrr-shortcuts"><i class="fa fa-check"></i><b>9.2.2</b> Anonymous functions and shortcuts</a></li>
<li class="chapter" data-level="9.2.3" data-path="functionals.html"><a href="functionals.html#passing-arguments"><i class="fa fa-check"></i><b>9.2.3</b> Passing arguments with <code>...</code></a></li>
<li class="chapter" data-level="9.2.4" data-path="functionals.html"><a href="functionals.html#argument-names"><i class="fa fa-check"></i><b>9.2.4</b> Argument names</a></li>
<li class="chapter" data-level="9.2.5" data-path="functionals.html"><a href="functionals.html#change-argument"><i class="fa fa-check"></i><b>9.2.5</b> Varying another argument</a></li>
<li class="chapter" data-level="9.2.6" data-path="functionals.html"><a href="functionals.html#exercises-28"><i class="fa fa-check"></i><b>9.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="functionals.html"><a href="functionals.html#purrr-style"><i class="fa fa-check"></i><b>9.3</b> Purrr style</a></li>
<li class="chapter" data-level="9.4" data-path="functionals.html"><a href="functionals.html#map-variants"><i class="fa fa-check"></i><b>9.4</b> Map variants</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="functionals.html"><a href="functionals.html#modify"><i class="fa fa-check"></i><b>9.4.1</b> Same type of output as input: <code>modify()</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="functionals.html"><a href="functionals.html#map2"><i class="fa fa-check"></i><b>9.4.2</b> Two inputs: <code>map2()</code> and friends</a></li>
<li class="chapter" data-level="9.4.3" data-path="functionals.html"><a href="functionals.html#no-outputs-walk-and-friends"><i class="fa fa-check"></i><b>9.4.3</b> No outputs: <code>walk()</code> and friends</a></li>
<li class="chapter" data-level="9.4.4" data-path="functionals.html"><a href="functionals.html#iterating-over-values-and-indices"><i class="fa fa-check"></i><b>9.4.4</b> Iterating over values and indices</a></li>
<li class="chapter" data-level="9.4.5" data-path="functionals.html"><a href="functionals.html#pmap"><i class="fa fa-check"></i><b>9.4.5</b> Any number of inputs: <code>pmap()</code> and friends</a></li>
<li class="chapter" data-level="9.4.6" data-path="functionals.html"><a href="functionals.html#exercises-29"><i class="fa fa-check"></i><b>9.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="functionals.html"><a href="functionals.html#reduce"><i class="fa fa-check"></i><b>9.5</b> Reduce family</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="functionals.html"><a href="functionals.html#basics-1"><i class="fa fa-check"></i><b>9.5.1</b> Basics</a></li>
<li class="chapter" data-level="9.5.2" data-path="functionals.html"><a href="functionals.html#accumulate"><i class="fa fa-check"></i><b>9.5.2</b> Accumulate</a></li>
<li class="chapter" data-level="9.5.3" data-path="functionals.html"><a href="functionals.html#output-types"><i class="fa fa-check"></i><b>9.5.3</b> Output types</a></li>
<li class="chapter" data-level="9.5.4" data-path="functionals.html"><a href="functionals.html#multiple-inputs"><i class="fa fa-check"></i><b>9.5.4</b> Multiple inputs</a></li>
<li class="chapter" data-level="9.5.5" data-path="functionals.html"><a href="functionals.html#map-reduce"><i class="fa fa-check"></i><b>9.5.5</b> Map-reduce</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="functionals.html"><a href="functionals.html#predicate-functionals"><i class="fa fa-check"></i><b>9.6</b> Predicate functionals</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="functionals.html"><a href="functionals.html#basics-2"><i class="fa fa-check"></i><b>9.6.1</b> Basics</a></li>
<li class="chapter" data-level="9.6.2" data-path="functionals.html"><a href="functionals.html#predicate-map"><i class="fa fa-check"></i><b>9.6.2</b> Map variants</a></li>
<li class="chapter" data-level="9.6.3" data-path="functionals.html"><a href="functionals.html#exercises-30"><i class="fa fa-check"></i><b>9.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="functionals.html"><a href="functionals.html#base-functionals"><i class="fa fa-check"></i><b>9.7</b> Base functionals</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="functionals.html"><a href="functionals.html#matrices-and-arrays"><i class="fa fa-check"></i><b>9.7.1</b> Matrices and arrays</a></li>
<li class="chapter" data-level="9.7.2" data-path="functionals.html"><a href="functionals.html#mathematical-concerns"><i class="fa fa-check"></i><b>9.7.2</b> Mathematical concerns</a></li>
<li class="chapter" data-level="9.7.3" data-path="functionals.html"><a href="functionals.html#exercises-31"><i class="fa fa-check"></i><b>9.7.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="function-factories.html"><a href="function-factories.html"><i class="fa fa-check"></i><b>10</b> Function factories</a>
<ul>
<li class="chapter" data-level="10.1" data-path="function-factories.html"><a href="function-factories.html#introduction-9"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="function-factories.html"><a href="function-factories.html#outline-8"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="function-factories.html"><a href="function-factories.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="function-factories.html"><a href="function-factories.html#factory-fundamentals"><i class="fa fa-check"></i><b>10.2</b> Factory fundamentals</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="function-factories.html"><a href="function-factories.html#environments-1"><i class="fa fa-check"></i><b>10.2.1</b> Environments</a></li>
<li class="chapter" data-level="10.2.2" data-path="function-factories.html"><a href="function-factories.html#diagram-conventions"><i class="fa fa-check"></i><b>10.2.2</b> Diagram conventions</a></li>
<li class="chapter" data-level="10.2.3" data-path="function-factories.html"><a href="function-factories.html#forcing-evaluation"><i class="fa fa-check"></i><b>10.2.3</b> Forcing evaluation</a></li>
<li class="chapter" data-level="10.2.4" data-path="function-factories.html"><a href="function-factories.html#stateful-funs"><i class="fa fa-check"></i><b>10.2.4</b> Stateful functions</a></li>
<li class="chapter" data-level="10.2.5" data-path="function-factories.html"><a href="function-factories.html#factory-pitfalls"><i class="fa fa-check"></i><b>10.2.5</b> Garbage collection</a></li>
<li class="chapter" data-level="10.2.6" data-path="function-factories.html"><a href="function-factories.html#exercises-32"><i class="fa fa-check"></i><b>10.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="function-factories.html"><a href="function-factories.html#graph-fact"><i class="fa fa-check"></i><b>10.3</b> Graphical factories</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="function-factories.html"><a href="function-factories.html#labelling"><i class="fa fa-check"></i><b>10.3.1</b> Labelling</a></li>
<li class="chapter" data-level="10.3.2" data-path="function-factories.html"><a href="function-factories.html#histogram-bins"><i class="fa fa-check"></i><b>10.3.2</b> Histogram bins</a></li>
<li class="chapter" data-level="10.3.3" data-path="function-factories.html"><a href="function-factories.html#ggsave"><i class="fa fa-check"></i><b>10.3.3</b> <code>ggsave()</code></a></li>
<li class="chapter" data-level="10.3.4" data-path="function-factories.html"><a href="function-factories.html#exercises-33"><i class="fa fa-check"></i><b>10.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="function-factories.html"><a href="function-factories.html#stat-fact"><i class="fa fa-check"></i><b>10.4</b> Statistical factories</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="function-factories.html"><a href="function-factories.html#box-cox-transformation"><i class="fa fa-check"></i><b>10.4.1</b> Box-Cox transformation</a></li>
<li class="chapter" data-level="10.4.2" data-path="function-factories.html"><a href="function-factories.html#bootstrap-generators"><i class="fa fa-check"></i><b>10.4.2</b> Bootstrap generators</a></li>
<li class="chapter" data-level="10.4.3" data-path="function-factories.html"><a href="function-factories.html#MLE"><i class="fa fa-check"></i><b>10.4.3</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="10.4.4" data-path="function-factories.html"><a href="function-factories.html#exercises-34"><i class="fa fa-check"></i><b>10.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="function-factories.html"><a href="function-factories.html#functional-factories"><i class="fa fa-check"></i><b>10.5</b> Function factories + functionals</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="function-factories.html"><a href="function-factories.html#exercises-35"><i class="fa fa-check"></i><b>10.5.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="function-operators.html"><a href="function-operators.html"><i class="fa fa-check"></i><b>11</b> Function operators</a>
<ul>
<li class="chapter" data-level="11.1" data-path="function-operators.html"><a href="function-operators.html#introduction-10"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="function-operators.html"><a href="function-operators.html#outline-9"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="function-operators.html"><a href="function-operators.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="function-operators.html"><a href="function-operators.html#existing-fos"><i class="fa fa-check"></i><b>11.2</b> Existing function operators</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="function-operators.html"><a href="function-operators.html#safely"><i class="fa fa-check"></i><b>11.2.1</b> Capturing errors with <code>purrr::safely()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="function-operators.html"><a href="function-operators.html#memoise"><i class="fa fa-check"></i><b>11.2.2</b> Caching computations with <code>memoise::memoise()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="function-operators.html"><a href="function-operators.html#exercises-36"><i class="fa fa-check"></i><b>11.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="function-operators.html"><a href="function-operators.html#fo-case-study"><i class="fa fa-check"></i><b>11.3</b> Case study: Creating your own function operators</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="function-operators.html"><a href="function-operators.html#exercises-37"><i class="fa fa-check"></i><b>11.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Object-oriented programming</b></span></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-systems"><i class="fa fa-check"></i>OOP systems</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-in-r"><i class="fa fa-check"></i>OOP in R</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#sloop"><i class="fa fa-check"></i>sloop</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="base-types.html"><a href="base-types.html"><i class="fa fa-check"></i><b>12</b> Base types</a>
<ul>
<li class="chapter" data-level="12.1" data-path="base-types.html"><a href="base-types.html#introduction-11"><i class="fa fa-check"></i><b>12.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="base-types.html"><a href="base-types.html#outline-10"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="base-types.html"><a href="base-types.html#base-vs-oo"><i class="fa fa-check"></i><b>12.2</b> Base versus OO objects</a></li>
<li class="chapter" data-level="12.3" data-path="base-types.html"><a href="base-types.html#base-types-2"><i class="fa fa-check"></i><b>12.3</b> Base types</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="base-types.html"><a href="base-types.html#numeric-type"><i class="fa fa-check"></i><b>12.3.1</b> Numeric type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="s3.html"><a href="s3.html"><i class="fa fa-check"></i><b>13</b> S3</a>
<ul>
<li class="chapter" data-level="13.1" data-path="s3.html"><a href="s3.html#introduction-12"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="s3.html"><a href="s3.html#outline-11"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s3.html"><a href="s3.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="s3.html"><a href="s3.html#s3-basics"><i class="fa fa-check"></i><b>13.2</b> Basics</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="s3.html"><a href="s3.html#exercises-38"><i class="fa fa-check"></i><b>13.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="s3.html"><a href="s3.html#s3-classes"><i class="fa fa-check"></i><b>13.3</b> Classes</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="s3.html"><a href="s3.html#s3-constructor"><i class="fa fa-check"></i><b>13.3.1</b> Constructors</a></li>
<li class="chapter" data-level="13.3.2" data-path="s3.html"><a href="s3.html#validators"><i class="fa fa-check"></i><b>13.3.2</b> Validators</a></li>
<li class="chapter" data-level="13.3.3" data-path="s3.html"><a href="s3.html#helpers"><i class="fa fa-check"></i><b>13.3.3</b> Helpers</a></li>
<li class="chapter" data-level="13.3.4" data-path="s3.html"><a href="s3.html#exercises-39"><i class="fa fa-check"></i><b>13.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="s3.html"><a href="s3.html#s3-methods"><i class="fa fa-check"></i><b>13.4</b> Generics and methods</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="s3.html"><a href="s3.html#method-dispatch"><i class="fa fa-check"></i><b>13.4.1</b> Method dispatch</a></li>
<li class="chapter" data-level="13.4.2" data-path="s3.html"><a href="s3.html#finding-methods"><i class="fa fa-check"></i><b>13.4.2</b> Finding methods</a></li>
<li class="chapter" data-level="13.4.3" data-path="s3.html"><a href="s3.html#s3-arguments"><i class="fa fa-check"></i><b>13.4.3</b> Creating methods</a></li>
<li class="chapter" data-level="13.4.4" data-path="s3.html"><a href="s3.html#exercises-40"><i class="fa fa-check"></i><b>13.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="s3.html"><a href="s3.html#object-styles"><i class="fa fa-check"></i><b>13.5</b> Object styles</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="s3.html"><a href="s3.html#exercises-41"><i class="fa fa-check"></i><b>13.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="s3.html"><a href="s3.html#s3-inheritance"><i class="fa fa-check"></i><b>13.6</b> Inheritance</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="s3.html"><a href="s3.html#nextmethod"><i class="fa fa-check"></i><b>13.6.1</b> <code>NextMethod()</code></a></li>
<li class="chapter" data-level="13.6.2" data-path="s3.html"><a href="s3.html#s3-subclassing"><i class="fa fa-check"></i><b>13.6.2</b> Allowing subclassing</a></li>
<li class="chapter" data-level="13.6.3" data-path="s3.html"><a href="s3.html#exercises-42"><i class="fa fa-check"></i><b>13.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="s3.html"><a href="s3.html#s3-dispatch"><i class="fa fa-check"></i><b>13.7</b> Dispatch details</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="s3.html"><a href="s3.html#implicit-class"><i class="fa fa-check"></i><b>13.7.1</b> S3 and base types</a></li>
<li class="chapter" data-level="13.7.2" data-path="s3.html"><a href="s3.html#internal-generics"><i class="fa fa-check"></i><b>13.7.2</b> Internal generics</a></li>
<li class="chapter" data-level="13.7.3" data-path="s3.html"><a href="s3.html#group-generics"><i class="fa fa-check"></i><b>13.7.3</b> Group generics</a></li>
<li class="chapter" data-level="13.7.4" data-path="s3.html"><a href="s3.html#double-dispatch"><i class="fa fa-check"></i><b>13.7.4</b> Double dispatch</a></li>
<li class="chapter" data-level="13.7.5" data-path="s3.html"><a href="s3.html#exercises-43"><i class="fa fa-check"></i><b>13.7.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>14</b> R6</a>
<ul>
<li class="chapter" data-level="14.1" data-path="r6.html"><a href="r6.html#introduction-13"><i class="fa fa-check"></i><b>14.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="r6.html"><a href="r6.html#outline-12"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="r6.html"><a href="r6.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="r6.html"><a href="r6.html#r6-classes"><i class="fa fa-check"></i><b>14.2</b> Classes and methods</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="r6.html"><a href="r6.html#method-chaining"><i class="fa fa-check"></i><b>14.2.1</b> Method chaining</a></li>
<li class="chapter" data-level="14.2.2" data-path="r6.html"><a href="r6.html#r6-important-methods"><i class="fa fa-check"></i><b>14.2.2</b> Important methods</a></li>
<li class="chapter" data-level="14.2.3" data-path="r6.html"><a href="r6.html#adding-methods-after-creation"><i class="fa fa-check"></i><b>14.2.3</b> Adding methods after creation</a></li>
<li class="chapter" data-level="14.2.4" data-path="r6.html"><a href="r6.html#inheritance"><i class="fa fa-check"></i><b>14.2.4</b> Inheritance</a></li>
<li class="chapter" data-level="14.2.5" data-path="r6.html"><a href="r6.html#introspection"><i class="fa fa-check"></i><b>14.2.5</b> Introspection</a></li>
<li class="chapter" data-level="14.2.6" data-path="r6.html"><a href="r6.html#exercises-44"><i class="fa fa-check"></i><b>14.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="r6.html"><a href="r6.html#r6-access"><i class="fa fa-check"></i><b>14.3</b> Controlling access</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="r6.html"><a href="r6.html#privacy"><i class="fa fa-check"></i><b>14.3.1</b> Privacy</a></li>
<li class="chapter" data-level="14.3.2" data-path="r6.html"><a href="r6.html#active-fields"><i class="fa fa-check"></i><b>14.3.2</b> Active fields</a></li>
<li class="chapter" data-level="14.3.3" data-path="r6.html"><a href="r6.html#exercises-45"><i class="fa fa-check"></i><b>14.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="r6.html"><a href="r6.html#r6-semantics"><i class="fa fa-check"></i><b>14.4</b> Reference semantics</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="r6.html"><a href="r6.html#reasoning"><i class="fa fa-check"></i><b>14.4.1</b> Reasoning</a></li>
<li class="chapter" data-level="14.4.2" data-path="r6.html"><a href="r6.html#finalizer"><i class="fa fa-check"></i><b>14.4.2</b> Finalizer</a></li>
<li class="chapter" data-level="14.4.3" data-path="r6.html"><a href="r6.html#r6-fields"><i class="fa fa-check"></i><b>14.4.3</b> R6 fields</a></li>
<li class="chapter" data-level="14.4.4" data-path="r6.html"><a href="r6.html#exercises-46"><i class="fa fa-check"></i><b>14.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="r6.html"><a href="r6.html#why-r6"><i class="fa fa-check"></i><b>14.5</b> Why R6?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="s4.html"><a href="s4.html"><i class="fa fa-check"></i><b>15</b> S4</a>
<ul>
<li class="chapter" data-level="15.1" data-path="s4.html"><a href="s4.html#introduction-14"><i class="fa fa-check"></i><b>15.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#outline-13"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#learning-more"><i class="fa fa-check"></i>Learning more</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="s4.html"><a href="s4.html#s4-basics"><i class="fa fa-check"></i><b>15.2</b> Basics</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="s4.html"><a href="s4.html#exercises-47"><i class="fa fa-check"></i><b>15.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="s4.html"><a href="s4.html#s4-classes"><i class="fa fa-check"></i><b>15.3</b> Classes</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="s4.html"><a href="s4.html#inheritance-1"><i class="fa fa-check"></i><b>15.3.1</b> Inheritance</a></li>
<li class="chapter" data-level="15.3.2" data-path="s4.html"><a href="s4.html#introspection-1"><i class="fa fa-check"></i><b>15.3.2</b> Introspection</a></li>
<li class="chapter" data-level="15.3.3" data-path="s4.html"><a href="s4.html#redefinition"><i class="fa fa-check"></i><b>15.3.3</b> Redefinition</a></li>
<li class="chapter" data-level="15.3.4" data-path="s4.html"><a href="s4.html#helper"><i class="fa fa-check"></i><b>15.3.4</b> Helper</a></li>
<li class="chapter" data-level="15.3.5" data-path="s4.html"><a href="s4.html#validator"><i class="fa fa-check"></i><b>15.3.5</b> Validator</a></li>
<li class="chapter" data-level="15.3.6" data-path="s4.html"><a href="s4.html#exercises-48"><i class="fa fa-check"></i><b>15.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="s4.html"><a href="s4.html#s4-generics"><i class="fa fa-check"></i><b>15.4</b> Generics and methods</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="s4.html"><a href="s4.html#signature"><i class="fa fa-check"></i><b>15.4.1</b> Signature</a></li>
<li class="chapter" data-level="15.4.2" data-path="s4.html"><a href="s4.html#methods"><i class="fa fa-check"></i><b>15.4.2</b> Methods</a></li>
<li class="chapter" data-level="15.4.3" data-path="s4.html"><a href="s4.html#show-method"><i class="fa fa-check"></i><b>15.4.3</b> Show method</a></li>
<li class="chapter" data-level="15.4.4" data-path="s4.html"><a href="s4.html#accessors"><i class="fa fa-check"></i><b>15.4.4</b> Accessors</a></li>
<li class="chapter" data-level="15.4.5" data-path="s4.html"><a href="s4.html#exercises-49"><i class="fa fa-check"></i><b>15.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="s4.html"><a href="s4.html#s4-dispatch"><i class="fa fa-check"></i><b>15.5</b> Method dispatch</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="s4.html"><a href="s4.html#single-dispatch"><i class="fa fa-check"></i><b>15.5.1</b> Single dispatch</a></li>
<li class="chapter" data-level="15.5.2" data-path="s4.html"><a href="s4.html#multiple-inheritance"><i class="fa fa-check"></i><b>15.5.2</b> Multiple inheritance</a></li>
<li class="chapter" data-level="15.5.3" data-path="s4.html"><a href="s4.html#multiple-dispatch"><i class="fa fa-check"></i><b>15.5.3</b> Multiple dispatch</a></li>
<li class="chapter" data-level="15.5.4" data-path="s4.html"><a href="s4.html#multiple-dispatch-and-multiple-inheritance"><i class="fa fa-check"></i><b>15.5.4</b> Multiple dispatch and multiple inheritance</a></li>
<li class="chapter" data-level="15.5.5" data-path="s4.html"><a href="s4.html#exercises-50"><i class="fa fa-check"></i><b>15.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="s4.html"><a href="s4.html#s4-s3"><i class="fa fa-check"></i><b>15.6</b> S4 and S3</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="s4.html"><a href="s4.html#classes"><i class="fa fa-check"></i><b>15.6.1</b> Classes</a></li>
<li class="chapter" data-level="15.6.2" data-path="s4.html"><a href="s4.html#generics"><i class="fa fa-check"></i><b>15.6.2</b> Generics</a></li>
<li class="chapter" data-level="15.6.3" data-path="s4.html"><a href="s4.html#exercises-51"><i class="fa fa-check"></i><b>15.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html"><i class="fa fa-check"></i><b>16</b> Trade-offs</a>
<ul>
<li class="chapter" data-level="16.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#introduction-15"><i class="fa fa-check"></i><b>16.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#outline-14"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-s4"><i class="fa fa-check"></i><b>16.2</b> S4 versus S3</a></li>
<li class="chapter" data-level="16.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-r6"><i class="fa fa-check"></i><b>16.3</b> R6 versus S3</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#namespacing"><i class="fa fa-check"></i><b>16.3.1</b> Namespacing</a></li>
<li class="chapter" data-level="16.3.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#threading-state"><i class="fa fa-check"></i><b>16.3.2</b> Threading state</a></li>
<li class="chapter" data-level="16.3.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#tradeoffs-pipe"><i class="fa fa-check"></i><b>16.3.3</b> Method chaining</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Metaprogramming</b></span></li>
<li class="chapter" data-level="" data-path="metaprogramming.html"><a href="metaprogramming.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="17" data-path="meta-big-picture.html"><a href="meta-big-picture.html"><i class="fa fa-check"></i><b>17</b> Big picture</a>
<ul>
<li class="chapter" data-level="17.1" data-path="meta-big-picture.html"><a href="meta-big-picture.html#introduction-16"><i class="fa fa-check"></i><b>17.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="meta-big-picture.html"><a href="meta-big-picture.html#outline-15"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="meta-big-picture.html"><a href="meta-big-picture.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="meta-big-picture.html"><a href="meta-big-picture.html#code-data"><i class="fa fa-check"></i><b>17.2</b> Code is data</a></li>
<li class="chapter" data-level="17.3" data-path="meta-big-picture.html"><a href="meta-big-picture.html#code-tree"><i class="fa fa-check"></i><b>17.3</b> Code is a tree</a></li>
<li class="chapter" data-level="17.4" data-path="meta-big-picture.html"><a href="meta-big-picture.html#coding-code"><i class="fa fa-check"></i><b>17.4</b> Code can generate code</a></li>
<li class="chapter" data-level="17.5" data-path="meta-big-picture.html"><a href="meta-big-picture.html#eval-intro"><i class="fa fa-check"></i><b>17.5</b> Evaluation runs code</a></li>
<li class="chapter" data-level="17.6" data-path="meta-big-picture.html"><a href="meta-big-picture.html#eval-funs"><i class="fa fa-check"></i><b>17.6</b> Customising evaluation with functions</a></li>
<li class="chapter" data-level="17.7" data-path="meta-big-picture.html"><a href="meta-big-picture.html#eval-data"><i class="fa fa-check"></i><b>17.7</b> Customising evaluation with data</a></li>
<li class="chapter" data-level="17.8" data-path="meta-big-picture.html"><a href="meta-big-picture.html#quosure-intro"><i class="fa fa-check"></i><b>17.8</b> Quosures</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="expressions.html"><a href="expressions.html"><i class="fa fa-check"></i><b>18</b> Expressions</a>
<ul>
<li class="chapter" data-level="18.1" data-path="expressions.html"><a href="expressions.html#introduction-17"><i class="fa fa-check"></i><b>18.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="expressions.html"><a href="expressions.html#outline-16"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="expressions.html"><a href="expressions.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="expressions.html"><a href="expressions.html#ast"><i class="fa fa-check"></i><b>18.2</b> Abstract syntax trees</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="expressions.html"><a href="expressions.html#drawing"><i class="fa fa-check"></i><b>18.2.1</b> Drawing</a></li>
<li class="chapter" data-level="18.2.2" data-path="expressions.html"><a href="expressions.html#non-code-components"><i class="fa fa-check"></i><b>18.2.2</b> Non-code components</a></li>
<li class="chapter" data-level="18.2.3" data-path="expressions.html"><a href="expressions.html#infix-calls"><i class="fa fa-check"></i><b>18.2.3</b> Infix calls</a></li>
<li class="chapter" data-level="18.2.4" data-path="expressions.html"><a href="expressions.html#exercises-52"><i class="fa fa-check"></i><b>18.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="expressions.html"><a href="expressions.html#expression-details"><i class="fa fa-check"></i><b>18.3</b> Expressions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="expressions.html"><a href="expressions.html#constants"><i class="fa fa-check"></i><b>18.3.1</b> Constants</a></li>
<li class="chapter" data-level="18.3.2" data-path="expressions.html"><a href="expressions.html#symbols"><i class="fa fa-check"></i><b>18.3.2</b> Symbols</a></li>
<li class="chapter" data-level="18.3.3" data-path="expressions.html"><a href="expressions.html#calls"><i class="fa fa-check"></i><b>18.3.3</b> Calls</a></li>
<li class="chapter" data-level="18.3.4" data-path="expressions.html"><a href="expressions.html#summary"><i class="fa fa-check"></i><b>18.3.4</b> Summary</a></li>
<li class="chapter" data-level="18.3.5" data-path="expressions.html"><a href="expressions.html#exercises-53"><i class="fa fa-check"></i><b>18.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="expressions.html"><a href="expressions.html#grammar"><i class="fa fa-check"></i><b>18.4</b> Parsing and grammar</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="expressions.html"><a href="expressions.html#operator-precedence"><i class="fa fa-check"></i><b>18.4.1</b> Operator precedence</a></li>
<li class="chapter" data-level="18.4.2" data-path="expressions.html"><a href="expressions.html#associativity"><i class="fa fa-check"></i><b>18.4.2</b> Associativity</a></li>
<li class="chapter" data-level="18.4.3" data-path="expressions.html"><a href="expressions.html#parsing"><i class="fa fa-check"></i><b>18.4.3</b> Parsing and deparsing</a></li>
<li class="chapter" data-level="18.4.4" data-path="expressions.html"><a href="expressions.html#exercises-54"><i class="fa fa-check"></i><b>18.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="expressions.html"><a href="expressions.html#ast-funs"><i class="fa fa-check"></i><b>18.5</b> Walking AST with recursive functions</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="expressions.html"><a href="expressions.html#finding-f-and-t"><i class="fa fa-check"></i><b>18.5.1</b> Finding F and T</a></li>
<li class="chapter" data-level="18.5.2" data-path="expressions.html"><a href="expressions.html#finding-all-variables-created-by-assignment"><i class="fa fa-check"></i><b>18.5.2</b> Finding all variables created by assignment</a></li>
<li class="chapter" data-level="18.5.3" data-path="expressions.html"><a href="expressions.html#exercises-55"><i class="fa fa-check"></i><b>18.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="expressions.html"><a href="expressions.html#expression-special"><i class="fa fa-check"></i><b>18.6</b> Specialised data structures</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="expressions.html"><a href="expressions.html#pairlists"><i class="fa fa-check"></i><b>18.6.1</b> Pairlists</a></li>
<li class="chapter" data-level="18.6.2" data-path="expressions.html"><a href="expressions.html#empty-symbol"><i class="fa fa-check"></i><b>18.6.2</b> Missing arguments</a></li>
<li class="chapter" data-level="18.6.3" data-path="expressions.html"><a href="expressions.html#expression-vectors"><i class="fa fa-check"></i><b>18.6.3</b> Expression vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>19</b> Quasiquotation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="quasiquotation.html"><a href="quasiquotation.html#introduction-18"><i class="fa fa-check"></i><b>19.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#outline-17"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#prerequisites-12"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#related-work"><i class="fa fa-check"></i>Related work</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="quasiquotation.html"><a href="quasiquotation.html#quasi-motivation"><i class="fa fa-check"></i><b>19.2</b> Motivation</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="quasiquotation.html"><a href="quasiquotation.html#vocabulary"><i class="fa fa-check"></i><b>19.2.1</b> Vocabulary</a></li>
<li class="chapter" data-level="19.2.2" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-56"><i class="fa fa-check"></i><b>19.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="quasiquotation.html"><a href="quasiquotation.html#quoting"><i class="fa fa-check"></i><b>19.3</b> Quoting</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="quasiquotation.html"><a href="quasiquotation.html#capturing-expressions"><i class="fa fa-check"></i><b>19.3.1</b> Capturing expressions</a></li>
<li class="chapter" data-level="19.3.2" data-path="quasiquotation.html"><a href="quasiquotation.html#capturing-symbols"><i class="fa fa-check"></i><b>19.3.2</b> Capturing symbols</a></li>
<li class="chapter" data-level="19.3.3" data-path="quasiquotation.html"><a href="quasiquotation.html#with-base-r"><i class="fa fa-check"></i><b>19.3.3</b> With base R</a></li>
<li class="chapter" data-level="19.3.4" data-path="quasiquotation.html"><a href="quasiquotation.html#substitution"><i class="fa fa-check"></i><b>19.3.4</b> Substitution</a></li>
<li class="chapter" data-level="19.3.5" data-path="quasiquotation.html"><a href="quasiquotation.html#summary-1"><i class="fa fa-check"></i><b>19.3.5</b> Summary</a></li>
<li class="chapter" data-level="19.3.6" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-57"><i class="fa fa-check"></i><b>19.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting"><i class="fa fa-check"></i><b>19.4</b> Unquoting</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-one-argument"><i class="fa fa-check"></i><b>19.4.1</b> Unquoting one argument</a></li>
<li class="chapter" data-level="19.4.2" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-a-function"><i class="fa fa-check"></i><b>19.4.2</b> Unquoting a function</a></li>
<li class="chapter" data-level="19.4.3" data-path="quasiquotation.html"><a href="quasiquotation.html#unquote-missing"><i class="fa fa-check"></i><b>19.4.3</b> Unquoting a missing argument</a></li>
<li class="chapter" data-level="19.4.4" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-in-special-forms"><i class="fa fa-check"></i><b>19.4.4</b> Unquoting in special forms</a></li>
<li class="chapter" data-level="19.4.5" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-many-arguments"><i class="fa fa-check"></i><b>19.4.5</b> Unquoting many arguments</a></li>
<li class="chapter" data-level="19.4.6" data-path="quasiquotation.html"><a href="quasiquotation.html#the-polite-fiction-of"><i class="fa fa-check"></i><b>19.4.6</b> The polite fiction of <code>!!</code></a></li>
<li class="chapter" data-level="19.4.7" data-path="quasiquotation.html"><a href="quasiquotation.html#non-standard-ast"><i class="fa fa-check"></i><b>19.4.7</b> Non-standard ASTs</a></li>
<li class="chapter" data-level="19.4.8" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-58"><i class="fa fa-check"></i><b>19.4.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="quasiquotation.html"><a href="quasiquotation.html#base-nonquote"><i class="fa fa-check"></i><b>19.5</b> Non-quoting</a></li>
<li class="chapter" data-level="19.6" data-path="quasiquotation.html"><a href="quasiquotation.html#tidy-dots"><i class="fa fa-check"></i><b>19.6</b> <code>...</code> (dot-dot-dot)</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="quasiquotation.html"><a href="quasiquotation.html#examples"><i class="fa fa-check"></i><b>19.6.1</b> Examples</a></li>
<li class="chapter" data-level="19.6.2" data-path="quasiquotation.html"><a href="quasiquotation.html#exec"><i class="fa fa-check"></i><b>19.6.2</b> <code>exec()</code></a></li>
<li class="chapter" data-level="19.6.3" data-path="quasiquotation.html"><a href="quasiquotation.html#dots_list"><i class="fa fa-check"></i><b>19.6.3</b> <code>dots_list()</code></a></li>
<li class="chapter" data-level="19.6.4" data-path="quasiquotation.html"><a href="quasiquotation.html#do-call"><i class="fa fa-check"></i><b>19.6.4</b> With base R</a></li>
<li class="chapter" data-level="19.6.5" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-59"><i class="fa fa-check"></i><b>19.6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="quasiquotation.html"><a href="quasiquotation.html#expr-case-studies"><i class="fa fa-check"></i><b>19.7</b> Case studies</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="quasiquotation.html"><a href="quasiquotation.html#lobstrast"><i class="fa fa-check"></i><b>19.7.1</b> <code>lobstr::ast()</code></a></li>
<li class="chapter" data-level="19.7.2" data-path="quasiquotation.html"><a href="quasiquotation.html#map-reduce-to-generate-code"><i class="fa fa-check"></i><b>19.7.2</b> Map-reduce to generate code</a></li>
<li class="chapter" data-level="19.7.3" data-path="quasiquotation.html"><a href="quasiquotation.html#slicing-an-array"><i class="fa fa-check"></i><b>19.7.3</b> Slicing an array</a></li>
<li class="chapter" data-level="19.7.4" data-path="quasiquotation.html"><a href="quasiquotation.html#new-function"><i class="fa fa-check"></i><b>19.7.4</b> Creating functions</a></li>
<li class="chapter" data-level="19.7.5" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-60"><i class="fa fa-check"></i><b>19.7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="quasiquotation.html"><a href="quasiquotation.html#history"><i class="fa fa-check"></i><b>19.8</b> History</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="evaluation.html"><a href="evaluation.html"><i class="fa fa-check"></i><b>20</b> Evaluation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="evaluation.html"><a href="evaluation.html#introduction-19"><i class="fa fa-check"></i><b>20.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="evaluation.html"><a href="evaluation.html#outline-18"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="evaluation.html"><a href="evaluation.html#prerequisites-13"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="evaluation.html"><a href="evaluation.html#eval"><i class="fa fa-check"></i><b>20.2</b> Evaluation basics</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="evaluation.html"><a href="evaluation.html#application-local"><i class="fa fa-check"></i><b>20.2.1</b> Application: <code>local()</code></a></li>
<li class="chapter" data-level="20.2.2" data-path="evaluation.html"><a href="evaluation.html#application-source"><i class="fa fa-check"></i><b>20.2.2</b> Application: <code>source()</code></a></li>
<li class="chapter" data-level="20.2.3" data-path="evaluation.html"><a href="evaluation.html#gotcha-function"><i class="fa fa-check"></i><b>20.2.3</b> Gotcha: <code>function()</code></a></li>
<li class="chapter" data-level="20.2.4" data-path="evaluation.html"><a href="evaluation.html#exercises-61"><i class="fa fa-check"></i><b>20.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="evaluation.html"><a href="evaluation.html#quosures"><i class="fa fa-check"></i><b>20.3</b> Quosures</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="evaluation.html"><a href="evaluation.html#creating"><i class="fa fa-check"></i><b>20.3.1</b> Creating</a></li>
<li class="chapter" data-level="20.3.2" data-path="evaluation.html"><a href="evaluation.html#evaluating"><i class="fa fa-check"></i><b>20.3.2</b> Evaluating</a></li>
<li class="chapter" data-level="20.3.3" data-path="evaluation.html"><a href="evaluation.html#quosure-dots"><i class="fa fa-check"></i><b>20.3.3</b> Dots</a></li>
<li class="chapter" data-level="20.3.4" data-path="evaluation.html"><a href="evaluation.html#quosure-impl"><i class="fa fa-check"></i><b>20.3.4</b> Under the hood</a></li>
<li class="chapter" data-level="20.3.5" data-path="evaluation.html"><a href="evaluation.html#nested-quosures"><i class="fa fa-check"></i><b>20.3.5</b> Nested quosures</a></li>
<li class="chapter" data-level="20.3.6" data-path="evaluation.html"><a href="evaluation.html#exercises-62"><i class="fa fa-check"></i><b>20.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="evaluation.html"><a href="evaluation.html#data-masks"><i class="fa fa-check"></i><b>20.4</b> Data masks</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="evaluation.html"><a href="evaluation.html#basics-3"><i class="fa fa-check"></i><b>20.4.1</b> Basics</a></li>
<li class="chapter" data-level="20.4.2" data-path="evaluation.html"><a href="evaluation.html#pronouns"><i class="fa fa-check"></i><b>20.4.2</b> Pronouns</a></li>
<li class="chapter" data-level="20.4.3" data-path="evaluation.html"><a href="evaluation.html#subset"><i class="fa fa-check"></i><b>20.4.3</b> Application: <code>subset()</code></a></li>
<li class="chapter" data-level="20.4.4" data-path="evaluation.html"><a href="evaluation.html#application-transform"><i class="fa fa-check"></i><b>20.4.4</b> Application: transform</a></li>
<li class="chapter" data-level="20.4.5" data-path="evaluation.html"><a href="evaluation.html#select"><i class="fa fa-check"></i><b>20.4.5</b> Application: <code>select()</code></a></li>
<li class="chapter" data-level="20.4.6" data-path="evaluation.html"><a href="evaluation.html#exercises-63"><i class="fa fa-check"></i><b>20.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="evaluation.html"><a href="evaluation.html#tidy-evaluation"><i class="fa fa-check"></i><b>20.5</b> Using tidy evaluation</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="evaluation.html"><a href="evaluation.html#quoting-and-unquoting"><i class="fa fa-check"></i><b>20.5.1</b> Quoting and unquoting</a></li>
<li class="chapter" data-level="20.5.2" data-path="evaluation.html"><a href="evaluation.html#handling-ambiguity"><i class="fa fa-check"></i><b>20.5.2</b> Handling ambiguity</a></li>
<li class="chapter" data-level="20.5.3" data-path="evaluation.html"><a href="evaluation.html#quoting-and-ambiguity"><i class="fa fa-check"></i><b>20.5.3</b> Quoting and ambiguity</a></li>
<li class="chapter" data-level="20.5.4" data-path="evaluation.html"><a href="evaluation.html#exercises-64"><i class="fa fa-check"></i><b>20.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="evaluation.html"><a href="evaluation.html#base-evaluation"><i class="fa fa-check"></i><b>20.6</b> Base evaluation</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="evaluation.html"><a href="evaluation.html#substitute"><i class="fa fa-check"></i><b>20.6.1</b> <code>substitute()</code></a></li>
<li class="chapter" data-level="20.6.2" data-path="evaluation.html"><a href="evaluation.html#match.call"><i class="fa fa-check"></i><b>20.6.2</b> <code>match.call()</code></a></li>
<li class="chapter" data-level="20.6.3" data-path="evaluation.html"><a href="evaluation.html#exercises-65"><i class="fa fa-check"></i><b>20.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="translation.html"><a href="translation.html"><i class="fa fa-check"></i><b>21</b> Translating R code</a>
<ul>
<li class="chapter" data-level="21.1" data-path="translation.html"><a href="translation.html#introduction-20"><i class="fa fa-check"></i><b>21.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="translation.html"><a href="translation.html#outline-19"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="translation.html"><a href="translation.html#prerequisites-14"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="translation.html"><a href="translation.html#html"><i class="fa fa-check"></i><b>21.2</b> HTML</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="translation.html"><a href="translation.html#goal"><i class="fa fa-check"></i><b>21.2.1</b> Goal</a></li>
<li class="chapter" data-level="21.2.2" data-path="translation.html"><a href="translation.html#escaping"><i class="fa fa-check"></i><b>21.2.2</b> Escaping</a></li>
<li class="chapter" data-level="21.2.3" data-path="translation.html"><a href="translation.html#basic-tag-functions"><i class="fa fa-check"></i><b>21.2.3</b> Basic tag functions</a></li>
<li class="chapter" data-level="21.2.4" data-path="translation.html"><a href="translation.html#tag-functions"><i class="fa fa-check"></i><b>21.2.4</b> Tag functions</a></li>
<li class="chapter" data-level="21.2.5" data-path="translation.html"><a href="translation.html#html-env"><i class="fa fa-check"></i><b>21.2.5</b> Processing all tags</a></li>
<li class="chapter" data-level="21.2.6" data-path="translation.html"><a href="translation.html#exercises-66"><i class="fa fa-check"></i><b>21.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="translation.html"><a href="translation.html#latex"><i class="fa fa-check"></i><b>21.3</b> LaTeX</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="translation.html"><a href="translation.html#latex-mathematics"><i class="fa fa-check"></i><b>21.3.1</b> LaTeX mathematics</a></li>
<li class="chapter" data-level="21.3.2" data-path="translation.html"><a href="translation.html#goal-1"><i class="fa fa-check"></i><b>21.3.2</b> Goal</a></li>
<li class="chapter" data-level="21.3.3" data-path="translation.html"><a href="translation.html#to_math"><i class="fa fa-check"></i><b>21.3.3</b> <code>to_math</code>()</a></li>
<li class="chapter" data-level="21.3.4" data-path="translation.html"><a href="translation.html#known-symbols"><i class="fa fa-check"></i><b>21.3.4</b> Known symbols</a></li>
<li class="chapter" data-level="21.3.5" data-path="translation.html"><a href="translation.html#unknown-symbols"><i class="fa fa-check"></i><b>21.3.5</b> Unknown symbols</a></li>
<li class="chapter" data-level="21.3.6" data-path="translation.html"><a href="translation.html#known-functions"><i class="fa fa-check"></i><b>21.3.6</b> Known functions</a></li>
<li class="chapter" data-level="21.3.7" data-path="translation.html"><a href="translation.html#unknown-functions"><i class="fa fa-check"></i><b>21.3.7</b> Unknown functions</a></li>
<li class="chapter" data-level="21.3.8" data-path="translation.html"><a href="translation.html#exercises-67"><i class="fa fa-check"></i><b>21.3.8</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Techniques</b></span></li>
<li class="chapter" data-level="" data-path="techniques.html"><a href="techniques.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="22" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>22</b> Debugging</a>
<ul>
<li class="chapter" data-level="22.1" data-path="debugging.html"><a href="debugging.html#introduction-21"><i class="fa fa-check"></i><b>22.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="debugging.html"><a href="debugging.html#outline-20"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="debugging.html"><a href="debugging.html#debugging-strategy"><i class="fa fa-check"></i><b>22.2</b> Overall approach</a></li>
<li class="chapter" data-level="22.3" data-path="debugging.html"><a href="debugging.html#traceback"><i class="fa fa-check"></i><b>22.3</b> Locating errors</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="debugging.html"><a href="debugging.html#debug-lazy"><i class="fa fa-check"></i><b>22.3.1</b> Lazy evaluation</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="debugging.html"><a href="debugging.html#browser"><i class="fa fa-check"></i><b>22.4</b> Interactive debugger</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="debugging.html"><a href="debugging.html#browser-commands"><i class="fa fa-check"></i><b>22.4.1</b> <code>browser()</code> commands</a></li>
<li class="chapter" data-level="22.4.2" data-path="debugging.html"><a href="debugging.html#alternatives"><i class="fa fa-check"></i><b>22.4.2</b> Alternatives</a></li>
<li class="chapter" data-level="22.4.3" data-path="debugging.html"><a href="debugging.html#debug-compiled"><i class="fa fa-check"></i><b>22.4.3</b> Compiled code</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="debugging.html"><a href="debugging.html#non-interactive-debugging"><i class="fa fa-check"></i><b>22.5</b> Non-interactive debugging</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="debugging.html"><a href="debugging.html#dump.frames"><i class="fa fa-check"></i><b>22.5.1</b> <code>dump.frames()</code></a></li>
<li class="chapter" data-level="22.5.2" data-path="debugging.html"><a href="debugging.html#print-debugging"><i class="fa fa-check"></i><b>22.5.2</b> Print debugging</a></li>
<li class="chapter" data-level="22.5.3" data-path="debugging.html"><a href="debugging.html#rmarkdown"><i class="fa fa-check"></i><b>22.5.3</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="debugging.html"><a href="debugging.html#non-error-failures"><i class="fa fa-check"></i><b>22.6</b> Non-error failures</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="perf-measure.html"><a href="perf-measure.html"><i class="fa fa-check"></i><b>23</b> Measuring performance</a>
<ul>
<li class="chapter" data-level="23.1" data-path="perf-measure.html"><a href="perf-measure.html#introduction-22"><i class="fa fa-check"></i><b>23.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="perf-measure.html"><a href="perf-measure.html#outline-21"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="perf-measure.html"><a href="perf-measure.html#prerequisites-15"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="perf-measure.html"><a href="perf-measure.html#profiling"><i class="fa fa-check"></i><b>23.2</b> Profiling</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="perf-measure.html"><a href="perf-measure.html#visualising-profiles"><i class="fa fa-check"></i><b>23.2.1</b> Visualising profiles</a></li>
<li class="chapter" data-level="23.2.2" data-path="perf-measure.html"><a href="perf-measure.html#memory-profiling"><i class="fa fa-check"></i><b>23.2.2</b> Memory profiling</a></li>
<li class="chapter" data-level="23.2.3" data-path="perf-measure.html"><a href="perf-measure.html#limitations"><i class="fa fa-check"></i><b>23.2.3</b> Limitations</a></li>
<li class="chapter" data-level="23.2.4" data-path="perf-measure.html"><a href="perf-measure.html#exercises-68"><i class="fa fa-check"></i><b>23.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="perf-measure.html"><a href="perf-measure.html#microbenchmarking"><i class="fa fa-check"></i><b>23.3</b> Microbenchmarking</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="perf-measure.html"><a href="perf-measure.html#benchmark-results"><i class="fa fa-check"></i><b>23.3.1</b> <code>bench::mark()</code> results</a></li>
<li class="chapter" data-level="23.3.2" data-path="perf-measure.html"><a href="perf-measure.html#interpreting-results"><i class="fa fa-check"></i><b>23.3.2</b> Interpreting results</a></li>
<li class="chapter" data-level="23.3.3" data-path="perf-measure.html"><a href="perf-measure.html#exercises-69"><i class="fa fa-check"></i><b>23.3.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="perf-improve.html"><a href="perf-improve.html"><i class="fa fa-check"></i><b>24</b> Improving performance</a>
<ul>
<li class="chapter" data-level="24.1" data-path="perf-improve.html"><a href="perf-improve.html#introduction-23"><i class="fa fa-check"></i><b>24.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="perf-improve.html"><a href="perf-improve.html#outline-22"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="perf-improve.html"><a href="perf-improve.html#prerequisites-16"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="perf-improve.html"><a href="perf-improve.html#code-organisation"><i class="fa fa-check"></i><b>24.2</b> Code organisation</a></li>
<li class="chapter" data-level="24.3" data-path="perf-improve.html"><a href="perf-improve.html#already-solved"><i class="fa fa-check"></i><b>24.3</b> Checking for existing solutions</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="perf-improve.html"><a href="perf-improve.html#exercises-70"><i class="fa fa-check"></i><b>24.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="perf-improve.html"><a href="perf-improve.html#be-lazy"><i class="fa fa-check"></i><b>24.4</b> Doing as little as possible</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="perf-improve.html"><a href="perf-improve.html#mean"><i class="fa fa-check"></i><b>24.4.1</b> <code>mean()</code></a></li>
<li class="chapter" data-level="24.4.2" data-path="perf-improve.html"><a href="perf-improve.html#as.data.frame"><i class="fa fa-check"></i><b>24.4.2</b> <code>as.data.frame()</code></a></li>
<li class="chapter" data-level="24.4.3" data-path="perf-improve.html"><a href="perf-improve.html#exercises-71"><i class="fa fa-check"></i><b>24.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="perf-improve.html"><a href="perf-improve.html#vectorise"><i class="fa fa-check"></i><b>24.5</b> Vectorise</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="perf-improve.html"><a href="perf-improve.html#exercises-72"><i class="fa fa-check"></i><b>24.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="perf-improve.html"><a href="perf-improve.html#avoid-copies"><i class="fa fa-check"></i><b>24.6</b> Avoiding copies</a></li>
<li class="chapter" data-level="24.7" data-path="perf-improve.html"><a href="perf-improve.html#t-test"><i class="fa fa-check"></i><b>24.7</b> Case study: t-test</a></li>
<li class="chapter" data-level="24.8" data-path="perf-improve.html"><a href="perf-improve.html#more-techniques"><i class="fa fa-check"></i><b>24.8</b> Other techniques</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>25</b> Rewriting R code in C++</a>
<ul>
<li class="chapter" data-level="25.1" data-path="rcpp.html"><a href="rcpp.html#introduction-24"><i class="fa fa-check"></i><b>25.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="rcpp.html"><a href="rcpp.html#outline-23"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="rcpp.html"><a href="rcpp.html#prerequisites-17"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro"><i class="fa fa-check"></i><b>25.2</b> Getting started with C++</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="rcpp.html"><a href="rcpp.html#no-inputs-scalar-output"><i class="fa fa-check"></i><b>25.2.1</b> No inputs, scalar output</a></li>
<li class="chapter" data-level="25.2.2" data-path="rcpp.html"><a href="rcpp.html#scalar-input-scalar-output"><i class="fa fa-check"></i><b>25.2.2</b> Scalar input, scalar output</a></li>
<li class="chapter" data-level="25.2.3" data-path="rcpp.html"><a href="rcpp.html#vector-input-scalar-output"><i class="fa fa-check"></i><b>25.2.3</b> Vector input, scalar output</a></li>
<li class="chapter" data-level="25.2.4" data-path="rcpp.html"><a href="rcpp.html#vector-input-vector-output"><i class="fa fa-check"></i><b>25.2.4</b> Vector input, vector output</a></li>
<li class="chapter" data-level="25.2.5" data-path="rcpp.html"><a href="rcpp.html#sourceCpp"><i class="fa fa-check"></i><b>25.2.5</b> Using sourceCpp</a></li>
<li class="chapter" data-level="25.2.6" data-path="rcpp.html"><a href="rcpp.html#exercise-started"><i class="fa fa-check"></i><b>25.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="rcpp.html"><a href="rcpp.html#rcpp-classes"><i class="fa fa-check"></i><b>25.3</b> Other classes</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="rcpp.html"><a href="rcpp.html#lists-and-data-frames"><i class="fa fa-check"></i><b>25.3.1</b> Lists and data frames</a></li>
<li class="chapter" data-level="25.3.2" data-path="rcpp.html"><a href="rcpp.html#functions-rcpp"><i class="fa fa-check"></i><b>25.3.2</b> Functions</a></li>
<li class="chapter" data-level="25.3.3" data-path="rcpp.html"><a href="rcpp.html#attributes-1"><i class="fa fa-check"></i><b>25.3.3</b> Attributes</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="rcpp.html"><a href="rcpp.html#rcpp-na"><i class="fa fa-check"></i><b>25.4</b> Missing values</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="rcpp.html"><a href="rcpp.html#scalars-1"><i class="fa fa-check"></i><b>25.4.1</b> Scalars</a></li>
<li class="chapter" data-level="25.4.2" data-path="rcpp.html"><a href="rcpp.html#strings"><i class="fa fa-check"></i><b>25.4.2</b> Strings</a></li>
<li class="chapter" data-level="25.4.3" data-path="rcpp.html"><a href="rcpp.html#boolean"><i class="fa fa-check"></i><b>25.4.3</b> Boolean</a></li>
<li class="chapter" data-level="25.4.4" data-path="rcpp.html"><a href="rcpp.html#vectors-rcpp"><i class="fa fa-check"></i><b>25.4.4</b> Vectors</a></li>
<li class="chapter" data-level="25.4.5" data-path="rcpp.html"><a href="rcpp.html#exercises-73"><i class="fa fa-check"></i><b>25.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="rcpp.html"><a href="rcpp.html#stl"><i class="fa fa-check"></i><b>25.5</b> Standard Template Library</a>
<ul>
<li class="chapter" data-level="25.5.1" data-path="rcpp.html"><a href="rcpp.html#using-iterators"><i class="fa fa-check"></i><b>25.5.1</b> Using iterators</a></li>
<li class="chapter" data-level="25.5.2" data-path="rcpp.html"><a href="rcpp.html#algorithms"><i class="fa fa-check"></i><b>25.5.2</b> Algorithms</a></li>
<li class="chapter" data-level="25.5.3" data-path="rcpp.html"><a href="rcpp.html#data-structures-rcpp"><i class="fa fa-check"></i><b>25.5.3</b> Data structures</a></li>
<li class="chapter" data-level="25.5.4" data-path="rcpp.html"><a href="rcpp.html#vectors-stl"><i class="fa fa-check"></i><b>25.5.4</b> Vectors</a></li>
<li class="chapter" data-level="25.5.5" data-path="rcpp.html"><a href="rcpp.html#sets"><i class="fa fa-check"></i><b>25.5.5</b> Sets</a></li>
<li class="chapter" data-level="25.5.6" data-path="rcpp.html"><a href="rcpp.html#map-1"><i class="fa fa-check"></i><b>25.5.6</b> Map</a></li>
<li class="chapter" data-level="25.5.7" data-path="rcpp.html"><a href="rcpp.html#exercises-74"><i class="fa fa-check"></i><b>25.5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.6" data-path="rcpp.html"><a href="rcpp.html#rcpp-case-studies"><i class="fa fa-check"></i><b>25.6</b> Case studies</a>
<ul>
<li class="chapter" data-level="25.6.1" data-path="rcpp.html"><a href="rcpp.html#gibbs-sampler"><i class="fa fa-check"></i><b>25.6.1</b> Gibbs sampler</a></li>
<li class="chapter" data-level="25.6.2" data-path="rcpp.html"><a href="rcpp.html#r-vectorisation-versus-c-vectorisation"><i class="fa fa-check"></i><b>25.6.2</b> R vectorisation versus C++ vectorisation</a></li>
</ul></li>
<li class="chapter" data-level="25.7" data-path="rcpp.html"><a href="rcpp.html#rcpp-package"><i class="fa fa-check"></i><b>25.7</b> Using Rcpp in a package</a></li>
<li class="chapter" data-level="25.8" data-path="rcpp.html"><a href="rcpp.html#rcpp-more"><i class="fa fa-check"></i><b>25.8</b> Learning more</a></li>
<li class="chapter" data-level="25.9" data-path="rcpp.html"><a href="rcpp.html#acknowledgments"><i class="fa fa-check"></i><b>25.9</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="s3" class="section level1" number="13">
<h1><span class="header-section-number">13</span> S3</h1>
<div id="introduction-12" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Introduction</h2>
<p></p>
<p>S3 is R’s first and simplest OO system. S3 is informal and ad hoc, but there is a certain elegance in its minimalism: you can’t take away any part of it and still have a useful OO system. For these reasons, you should use it, unless you have a compelling reason to do otherwise. S3 is the only OO system used in the base and stats packages, and it’s the most commonly used system in CRAN packages.</p>
<p>S3 is very flexible, which means it allows you to do things that are quite ill-advised. If you’re coming from a strict environment like Java this will seem pretty frightening, but it gives R programmers a tremendous amount of freedom. It may be very difficult to prevent people from doing something you don’t want them to do, but your users will never be held back because there is something you haven’t implemented yet. Since S3 has few built-in constraints, the key to its successful use is applying the constraints yourself. This chapter will therefore teach you the conventions you should (almost) always follow.</p>
<p>The goal of this chapter is to show you how the S3 system works, not how to use it effectively to create new classes and generics. I’d recommend coupling the theoretical knowledge from this chapter with the practical knowledge encoded in the <a href="https://vctrs.r-lib.org">vctrs package</a>.</p>
<div id="outline-11" class="section level3 unnumbered">
<h3>Outline</h3>
<ul>
<li><p>Section <a href="s3.html#s3-basics">13.2</a> gives a rapid overview of all the main components
of S3: classes, generics, and methods. You’ll also learn about
<code>sloop::s3_dispatch()</code>, which we’ll use throughout the chapter to explore
how S3 works.</p></li>
<li><p>Section <a href="s3.html#s3-classes">13.3</a> goes into the details of creating a new S3 class,
including the three functions that should accompany most classes:
a constructor, a helper, and a validator.</p></li>
<li><p>Section <a href="s3.html#s3-methods">13.4</a> describes how S3 generics and methods work,
including the basics of method dispatch.</p></li>
<li><p>Section <a href="s3.html#object-styles">13.5</a> discusses the four main styles of S3 objects:
vector, record, data frame, and scalar.</p></li>
<li><p>Section <a href="s3.html#s3-inheritance">13.6</a> demonstrates how inheritance works in S3,
and shows you what you need to make a class “subclassable.”</p></li>
<li><p>Section <a href="s3.html#s3-dispatch">13.7</a> concludes the chapter with a discussion of the
finer details of method dispatch including base types, internal generics,
group generics, and double dispatch.</p></li>
</ul>
</div>
<div id="prerequisites-6" class="section level3 unnumbered">
<h3>Prerequisites</h3>
<p>S3 classes are implemented using attributes, so make sure you’re familiar with the details described in Section <a href="vectors-chap.html#attributes">3.3</a>. We’ll use existing base S3 vectors for examples and exploration, so make sure that you’re familiar with the factor, Date, difftime, POSIXct, and POSIXlt classes described in Section <a href="vectors-chap.html#s3-atomic-vectors">3.4</a>.</p>
<p>We’ll use the <a href="https://sloop.r-lib.org">sloop</a> package for its interactive helpers.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="s3.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sloop)</span></code></pre></div>
</div>
</div>
<div id="s3-basics" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Basics</h2>
<p>

</p>
<p>An S3 object is a base type with at least a <code>class</code> attribute (other attributes may be used to store other data). For example, take the factor. Its base type is the integer vector, it has a <code>class</code> attribute of “factor,” and a <code>levels</code> attribute that stores the possible levels:</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="s3.html#cb538-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span>
<span id="cb538-2"><a href="s3.html#cb538-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-3"><a href="s3.html#cb538-3" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(f)</span>
<span id="cb538-4"><a href="s3.html#cb538-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;integer&quot;</span></span>
<span id="cb538-5"><a href="s3.html#cb538-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(f)</span>
<span id="cb538-6"><a href="s3.html#cb538-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $levels</span></span>
<span id="cb538-7"><a href="s3.html#cb538-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</span></span>
<span id="cb538-8"><a href="s3.html#cb538-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb538-9"><a href="s3.html#cb538-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $class</span></span>
<span id="cb538-10"><a href="s3.html#cb538-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;factor&quot;</span></span></code></pre></div>
<p>You can get the underlying base type by <code>unclass()</code>ing it, which strips the class attribute, causing it to lose its special behaviour:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="s3.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unclass</span>(f)</span>
<span id="cb539-2"><a href="s3.html#cb539-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3</span></span>
<span id="cb539-3"><a href="s3.html#cb539-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;levels&quot;)</span></span>
<span id="cb539-4"><a href="s3.html#cb539-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</span></span></code></pre></div>
<p>
</p>
<p>An S3 object behaves differently from its underlying base type whenever it’s passed to a <strong>generic</strong> (short for generic function). The easiest way to tell if a function is a generic is to use <code>sloop::ftype()</code> and look for “generic” in the output:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="s3.html#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftype</span>(print)</span>
<span id="cb540-2"><a href="s3.html#cb540-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;S3&quot;      &quot;generic&quot;</span></span>
<span id="cb540-3"><a href="s3.html#cb540-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ftype</span>(str)</span>
<span id="cb540-4"><a href="s3.html#cb540-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;S3&quot;      &quot;generic&quot;</span></span>
<span id="cb540-5"><a href="s3.html#cb540-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ftype</span>(unclass)</span>
<span id="cb540-6"><a href="s3.html#cb540-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;primitive&quot;</span></span></code></pre></div>
<p>A generic function defines an interface, which uses a different implementation depending on the class of an argument (almost always the first argument). Many base R functions are generic, including the important <code>print()</code>:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="s3.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f)</span>
<span id="cb541-2"><a href="s3.html#cb541-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] a b c</span></span>
<span id="cb541-3"><a href="s3.html#cb541-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Levels: a b c</span></span>
<span id="cb541-4"><a href="s3.html#cb541-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-5"><a href="s3.html#cb541-5" aria-hidden="true" tabindex="-1"></a><span class="co"># stripping class reverts to integer behaviour</span></span>
<span id="cb541-6"><a href="s3.html#cb541-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unclass</span>(f))</span>
<span id="cb541-7"><a href="s3.html#cb541-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3</span></span>
<span id="cb541-8"><a href="s3.html#cb541-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;levels&quot;)</span></span>
<span id="cb541-9"><a href="s3.html#cb541-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</span></span></code></pre></div>
<p>Beware that <code>str()</code> is generic, and some S3 classes use that generic to hide the internal details. For example, the <code>POSIXlt</code> class used to represent date-time data is actually built on top of a list, a fact which is hidden by its <code>str()</code> method:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="s3.html#cb542-1" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">strptime</span>(<span class="fu">c</span>(<span class="st">&quot;2017-01-01&quot;</span>, <span class="st">&quot;2020-05-04 03:21&quot;</span>), <span class="st">&quot;%Y-%m-%d&quot;</span>)</span>
<span id="cb542-2"><a href="s3.html#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(time)</span>
<span id="cb542-3"><a href="s3.html#cb542-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  POSIXlt[1:2], format: &quot;2017-01-01&quot; &quot;2020-05-04&quot;</span></span>
<span id="cb542-4"><a href="s3.html#cb542-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-5"><a href="s3.html#cb542-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">unclass</span>(time))</span>
<span id="cb542-6"><a href="s3.html#cb542-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 11</span></span>
<span id="cb542-7"><a href="s3.html#cb542-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ sec   : num [1:2] 0 0</span></span>
<span id="cb542-8"><a href="s3.html#cb542-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ min   : int [1:2] 0 0</span></span>
<span id="cb542-9"><a href="s3.html#cb542-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ hour  : int [1:2] 0 0</span></span>
<span id="cb542-10"><a href="s3.html#cb542-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ mday  : int [1:2] 1 4</span></span>
<span id="cb542-11"><a href="s3.html#cb542-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ mon   : int [1:2] 0 4</span></span>
<span id="cb542-12"><a href="s3.html#cb542-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ year  : int [1:2] 117 120</span></span>
<span id="cb542-13"><a href="s3.html#cb542-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ wday  : int [1:2] 0 1</span></span>
<span id="cb542-14"><a href="s3.html#cb542-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ yday  : int [1:2] 0 124</span></span>
<span id="cb542-15"><a href="s3.html#cb542-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ isdst : int [1:2] 0 0</span></span>
<span id="cb542-16"><a href="s3.html#cb542-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ zone  : chr [1:2] &quot;UTC&quot; &quot;UTC&quot;</span></span>
<span id="cb542-17"><a href="s3.html#cb542-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ gmtoff: int [1:2] NA NA</span></span></code></pre></div>
<p>The generic is a middleman: its job is to define the interface (i.e. the arguments) then find the right implementation for the job. The implementation for a specific class is called a <strong>method</strong>, and the generic finds that method by performing <strong>method dispatch</strong>.</p>
<p>You can use <code>sloop::s3_dispatch()</code> to see the process of method dispatch:</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="s3.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">print</span>(f))</span>
<span id="cb543-2"><a href="s3.html#cb543-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; print.factor</span></span>
<span id="cb543-3"><a href="s3.html#cb543-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  * print.default</span></span></code></pre></div>
<p>
We’ll come back to the details of dispatch in Section <a href="s3.html#method-dispatch">13.4.1</a>, for now note that S3 methods are functions with a special naming scheme, <code>generic.class()</code>. For example, the <code>factor</code> method for the <code>print()</code> generic is called <code>print.factor()</code>. You should never call the method directly, but instead rely on the generic to find it for you.</p>
<p>Generally, you can identify a method by the presence of <code>.</code> in the function name, but there are a number of important functions in base R that were written before S3, and hence use <code>.</code> to join words. If you’re unsure, check with <code>sloop::ftype()</code>:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="s3.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftype</span>(t.test)</span>
<span id="cb544-2"><a href="s3.html#cb544-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;S3&quot;      &quot;generic&quot;</span></span>
<span id="cb544-3"><a href="s3.html#cb544-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ftype</span>(t.data.frame)</span>
<span id="cb544-4"><a href="s3.html#cb544-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;S3&quot;     &quot;method&quot;</span></span></code></pre></div>
<p>
Unlike most functions, you can’t see the source code for most S3 methods<a href="#fn68" class="footnote-ref" id="fnref68"><sup>68</sup></a> just by typing their names. That’s because S3 methods are not usually exported: they live only inside the package, and are not available from the global environment. Instead, you can use <code>sloop::s3_get_method()</code>, which will work regardless of where the method lives:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="s3.html#cb545-1" aria-hidden="true" tabindex="-1"></a>weighted.mean.Date</span>
<span id="cb545-2"><a href="s3.html#cb545-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): object &#39;weighted.mean.Date&#39; not found</span></span>
<span id="cb545-3"><a href="s3.html#cb545-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-4"><a href="s3.html#cb545-4" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_get_method</span>(weighted.mean.Date)</span>
<span id="cb545-5"><a href="s3.html#cb545-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function (x, w, ...) </span></span>
<span id="cb545-6"><a href="s3.html#cb545-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; .Date(weighted.mean(unclass(x), w, ...))</span></span>
<span id="cb545-7"><a href="s3.html#cb545-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;bytecode: 0x556e06ec0d10&gt;</span></span>
<span id="cb545-8"><a href="s3.html#cb545-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: namespace:stats&gt;</span></span></code></pre></div>
<div id="exercises-38" class="section level3" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Describe the difference between <code>t.test()</code> and <code>t.data.frame()</code>.
When is each function called?</p></li>
<li><p>Make a list of commonly used base R functions that contain <code>.</code> in their
name but are not S3 methods.</p></li>
<li><p>What does the <code>as.data.frame.data.frame()</code> method do? Why is
it confusing? How could you avoid this confusion in your own
code?</p></li>
<li><p>Describe the difference in behaviour in these two calls.</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="s3.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb546-2"><a href="s3.html#cb546-2" aria-hidden="true" tabindex="-1"></a>some_days <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2017-01-31&quot;</span>) <span class="sc">+</span> <span class="fu">sample</span>(<span class="dv">10</span>, <span class="dv">5</span>)</span>
<span id="cb546-3"><a href="s3.html#cb546-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-4"><a href="s3.html#cb546-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(some_days)</span>
<span id="cb546-5"><a href="s3.html#cb546-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2017-02-06&quot;</span></span>
<span id="cb546-6"><a href="s3.html#cb546-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">unclass</span>(some_days))</span>
<span id="cb546-7"><a href="s3.html#cb546-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 17203</span></span></code></pre></div></li>
<li><p>What class of object does the following code return? What base type is it
built on? What attributes does it use?</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="s3.html#cb547-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(<span class="fu">rpois</span>(<span class="dv">100</span>, <span class="dv">10</span>))</span>
<span id="cb547-2"><a href="s3.html#cb547-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb547-3"><a href="s3.html#cb547-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Empirical CDF </span></span>
<span id="cb547-4"><a href="s3.html#cb547-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call: ecdf(rpois(100, 10))</span></span>
<span id="cb547-5"><a href="s3.html#cb547-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  x[1:18] =  2,  3,  4,  ..., 2e+01, 2e+01</span></span></code></pre></div></li>
<li><p>What class of object does the following code return? What base type is it
built on? What attributes does it use?</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="s3.html#cb548-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">rpois</span>(<span class="dv">100</span>, <span class="dv">5</span>))</span>
<span id="cb548-2"><a href="s3.html#cb548-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb548-3"><a href="s3.html#cb548-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb548-4"><a href="s3.html#cb548-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 </span></span>
<span id="cb548-5"><a href="s3.html#cb548-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  5 18 14 15 15 14  4  5  3</span></span></code></pre></div></li>
</ol>
</div>
</div>
<div id="s3-classes" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Classes</h2>
<p>

</p>
<p>If you have done object-oriented programming in other languages, you may be surprised to learn that S3 has no formal definition of a class: to make an object an instance of a class, you simply set the <strong>class attribute</strong>. You can do that during creation with <code>structure()</code>, or after the fact with <code>class&lt;-()</code>:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="s3.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and assign class in one step</span></span>
<span id="cb549-2"><a href="s3.html#cb549-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">list</span>(), <span class="at">class =</span> <span class="st">&quot;my_class&quot;</span>)</span>
<span id="cb549-3"><a href="s3.html#cb549-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-4"><a href="s3.html#cb549-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create, then set class</span></span>
<span id="cb549-5"><a href="s3.html#cb549-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb549-6"><a href="s3.html#cb549-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x) <span class="ot">&lt;-</span> <span class="st">&quot;my_class&quot;</span></span></code></pre></div>
<p>You can determine the class of an S3 object with <code>class(x)</code>, and see if an object is an instance of a class using <code>inherits(x, "classname")</code>.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="s3.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span>
<span id="cb550-2"><a href="s3.html#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;my_class&quot;</span></span>
<span id="cb550-3"><a href="s3.html#cb550-3" aria-hidden="true" tabindex="-1"></a><span class="fu">inherits</span>(x, <span class="st">&quot;my_class&quot;</span>)</span>
<span id="cb550-4"><a href="s3.html#cb550-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb550-5"><a href="s3.html#cb550-5" aria-hidden="true" tabindex="-1"></a><span class="fu">inherits</span>(x, <span class="st">&quot;your_class&quot;</span>)</span>
<span id="cb550-6"><a href="s3.html#cb550-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>The class name can be any string, but I recommend using only letters and <code>_</code>. Avoid <code>.</code> because (as mentioned earlier) it can be confused with the <code>.</code> separator between a generic name and a class name. When using a class in a package, I recommend including the package name in the class name. That ensures you won’t accidentally clash with a class defined by another package.</p>
<p>S3 has no checks for correctness which means you can change the class of existing objects:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="s3.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a linear model</span></span>
<span id="cb551-2"><a href="s3.html#cb551-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> <span class="fu">log</span>(disp), <span class="at">data =</span> mtcars)</span>
<span id="cb551-3"><a href="s3.html#cb551-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mod)</span>
<span id="cb551-4"><a href="s3.html#cb551-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;lm&quot;</span></span>
<span id="cb551-5"><a href="s3.html#cb551-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mod)</span>
<span id="cb551-6"><a href="s3.html#cb551-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb551-7"><a href="s3.html#cb551-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb551-8"><a href="s3.html#cb551-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = log(mpg) ~ log(disp), data = mtcars)</span></span>
<span id="cb551-9"><a href="s3.html#cb551-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb551-10"><a href="s3.html#cb551-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb551-11"><a href="s3.html#cb551-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    log(disp)  </span></span>
<span id="cb551-12"><a href="s3.html#cb551-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       5.381       -0.459</span></span>
<span id="cb551-13"><a href="s3.html#cb551-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-14"><a href="s3.html#cb551-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn it into a date (?!)</span></span>
<span id="cb551-15"><a href="s3.html#cb551-15" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mod) <span class="ot">&lt;-</span> <span class="st">&quot;Date&quot;</span></span>
<span id="cb551-16"><a href="s3.html#cb551-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-17"><a href="s3.html#cb551-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Unsurprisingly this doesn&#39;t work very well</span></span>
<span id="cb551-18"><a href="s3.html#cb551-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mod)</span>
<span id="cb551-19"><a href="s3.html#cb551-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in as.POSIXlt.Date(x): &#39;list&#39; object cannot be coerced to type &#39;double&#39;</span></span></code></pre></div>
<p>If you’ve used other OO languages, this might make you feel queasy, but in practice this flexibility causes few problems. R doesn’t stop you from shooting yourself in the foot, but as long as you don’t aim the gun at your toes and pull the trigger, you won’t have a problem.</p>
<p>To avoid foot-bullet intersections when creating your own class, I recommend that you usually provide three functions:</p>
<ul>
<li><p>A low-level <strong>constructor</strong>, <code>new_myclass()</code>, that efficiently creates new
objects with the correct structure.</p></li>
<li><p>A <strong>validator</strong>, <code>validate_myclass()</code>, that performs more computationally
expensive checks to ensure that the object has correct values.</p></li>
<li><p>A user-friendly <strong>helper</strong>, <code>myclass()</code>, that provides a convenient way for
others to create objects of your class.</p></li>
</ul>
<p>You don’t need a validator for very simple classes, and you can skip the helper if the class is for internal use only, but you should always provide a constructor.</p>
<div id="s3-constructor" class="section level3" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Constructors</h3>
<p>
</p>
<p>S3 doesn’t provide a formal definition of a class, so it has no built-in way to ensure that all objects of a given class have the same structure (i.e. the same base type and the same attributes with the same types). Instead, you must enforce a consistent structure by using a <strong>constructor</strong>.</p>
<p>The constructor should follow three principles:</p>
<ul>
<li><p>Be called <code>new_myclass()</code>.</p></li>
<li><p>Have one argument for the base object, and one for each attribute.</p></li>
<li><p>Check the type of the base object and the types of each attribute.</p></li>
</ul>
<p>I’ll illustrate these ideas by creating constructors for base classes<a href="#fn69" class="footnote-ref" id="fnref69"><sup>69</sup></a> that you’re already familiar with. To start, lets make a constructor for the simplest S3 class: <code>Date</code>. A <code>Date</code> is just a double with a single attribute: its <code>class</code> is “Date.” This makes for a very simple constructor:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="s3.html#cb552-1" aria-hidden="true" tabindex="-1"></a>new_Date <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">double</span>()) {</span>
<span id="cb552-2"><a href="s3.html#cb552-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.double</span>(x))</span>
<span id="cb552-3"><a href="s3.html#cb552-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">structure</span>(x, <span class="at">class =</span> <span class="st">&quot;Date&quot;</span>)</span>
<span id="cb552-4"><a href="s3.html#cb552-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb552-5"><a href="s3.html#cb552-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-6"><a href="s3.html#cb552-6" aria-hidden="true" tabindex="-1"></a><span class="fu">new_Date</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb552-7"><a href="s3.html#cb552-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1969-12-31&quot; &quot;1970-01-01&quot; &quot;1970-01-02&quot;</span></span></code></pre></div>
<p>The purpose of constructors is to help you, the developer. That means you can keep them simple, and you don’t need to optimise error messages for public consumption. If you expect users to also create objects, you should create a friendly helper function, called <code>class_name()</code>, which I’ll describe shortly.</p>
<p>A slightly more complicated constructor is that for <code>difftime</code>, which is used to represent time differences. It is again built on a double, but has a <code>units</code> attribute that must take one of a small set of values:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="s3.html#cb553-1" aria-hidden="true" tabindex="-1"></a>new_difftime <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">double</span>(), <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>) {</span>
<span id="cb553-2"><a href="s3.html#cb553-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.double</span>(x))</span>
<span id="cb553-3"><a href="s3.html#cb553-3" aria-hidden="true" tabindex="-1"></a>  units <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(units, <span class="fu">c</span>(<span class="st">&quot;secs&quot;</span>, <span class="st">&quot;mins&quot;</span>, <span class="st">&quot;hours&quot;</span>, <span class="st">&quot;days&quot;</span>, <span class="st">&quot;weeks&quot;</span>))</span>
<span id="cb553-4"><a href="s3.html#cb553-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-5"><a href="s3.html#cb553-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">structure</span>(x,</span>
<span id="cb553-6"><a href="s3.html#cb553-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">class =</span> <span class="st">&quot;difftime&quot;</span>,</span>
<span id="cb553-7"><a href="s3.html#cb553-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> units</span>
<span id="cb553-8"><a href="s3.html#cb553-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb553-9"><a href="s3.html#cb553-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb553-10"><a href="s3.html#cb553-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-11"><a href="s3.html#cb553-11" aria-hidden="true" tabindex="-1"></a><span class="fu">new_difftime</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">3600</span>), <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb553-12"><a href="s3.html#cb553-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time differences in secs</span></span>
<span id="cb553-13"><a href="s3.html#cb553-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]    1   10 3600</span></span>
<span id="cb553-14"><a href="s3.html#cb553-14" aria-hidden="true" tabindex="-1"></a><span class="fu">new_difftime</span>(<span class="dv">52</span>, <span class="st">&quot;weeks&quot;</span>)</span>
<span id="cb553-15"><a href="s3.html#cb553-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time difference of 52 weeks</span></span></code></pre></div>
<p>The constructor is a developer function: it will be called in many places, by an experienced user. That means it’s OK to trade a little safety in return for performance, and you should avoid potentially time-consuming checks in the constructor.</p>
</div>
<div id="validators" class="section level3" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Validators</h3>
<p>
</p>
<p>More complicated classes require more complicated checks for validity. Take factors, for example. A constructor only checks that types are correct, making it possible to create malformed factors:</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="s3.html#cb554-1" aria-hidden="true" tabindex="-1"></a>new_factor <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">integer</span>(), <span class="at">levels =</span> <span class="fu">character</span>()) {</span>
<span id="cb554-2"><a href="s3.html#cb554-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(x))</span>
<span id="cb554-3"><a href="s3.html#cb554-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.character</span>(levels))</span>
<span id="cb554-4"><a href="s3.html#cb554-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-5"><a href="s3.html#cb554-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">structure</span>(</span>
<span id="cb554-6"><a href="s3.html#cb554-6" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb554-7"><a href="s3.html#cb554-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> levels,</span>
<span id="cb554-8"><a href="s3.html#cb554-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">class =</span> <span class="st">&quot;factor&quot;</span></span>
<span id="cb554-9"><a href="s3.html#cb554-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb554-10"><a href="s3.html#cb554-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb554-11"><a href="s3.html#cb554-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-12"><a href="s3.html#cb554-12" aria-hidden="true" tabindex="-1"></a><span class="fu">new_factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb554-13"><a href="s3.html#cb554-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in as.character.factor(x): malformed factor</span></span>
<span id="cb554-14"><a href="s3.html#cb554-14" aria-hidden="true" tabindex="-1"></a><span class="fu">new_factor</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb554-15"><a href="s3.html#cb554-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in as.character.factor(x): malformed factor</span></span></code></pre></div>
<p>Rather than encumbering the constructor with complicated checks, it’s better to put them in a separate function. Doing so allows you to cheaply create new objects when you know that the values are correct, and easily re-use the checks in other places.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="s3.html#cb555-1" aria-hidden="true" tabindex="-1"></a>validate_factor <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb555-2"><a href="s3.html#cb555-2" aria-hidden="true" tabindex="-1"></a>  values <span class="ot">&lt;-</span> <span class="fu">unclass</span>(x)</span>
<span id="cb555-3"><a href="s3.html#cb555-3" aria-hidden="true" tabindex="-1"></a>  levels <span class="ot">&lt;-</span> <span class="fu">attr</span>(x, <span class="st">&quot;levels&quot;</span>)</span>
<span id="cb555-4"><a href="s3.html#cb555-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-5"><a href="s3.html#cb555-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(values) <span class="sc">&amp;</span> values <span class="sc">&gt;</span> <span class="dv">0</span>)) {</span>
<span id="cb555-6"><a href="s3.html#cb555-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(</span>
<span id="cb555-7"><a href="s3.html#cb555-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;All `x` values must be non-missing and greater than zero&quot;</span>,</span>
<span id="cb555-8"><a href="s3.html#cb555-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">call. =</span> <span class="cn">FALSE</span></span>
<span id="cb555-9"><a href="s3.html#cb555-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb555-10"><a href="s3.html#cb555-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb555-11"><a href="s3.html#cb555-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-12"><a href="s3.html#cb555-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(levels) <span class="sc">&lt;</span> <span class="fu">max</span>(values)) {</span>
<span id="cb555-13"><a href="s3.html#cb555-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(</span>
<span id="cb555-14"><a href="s3.html#cb555-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;There must be at least as many `levels` as possible values in `x`&quot;</span>,</span>
<span id="cb555-15"><a href="s3.html#cb555-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">call. =</span> <span class="cn">FALSE</span></span>
<span id="cb555-16"><a href="s3.html#cb555-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb555-17"><a href="s3.html#cb555-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb555-18"><a href="s3.html#cb555-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-19"><a href="s3.html#cb555-19" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb555-20"><a href="s3.html#cb555-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb555-21"><a href="s3.html#cb555-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-22"><a href="s3.html#cb555-22" aria-hidden="true" tabindex="-1"></a><span class="fu">validate_factor</span>(<span class="fu">new_factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">&quot;a&quot;</span>))</span>
<span id="cb555-23"><a href="s3.html#cb555-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: There must be at least as many `levels` as possible values in `x`</span></span>
<span id="cb555-24"><a href="s3.html#cb555-24" aria-hidden="true" tabindex="-1"></a><span class="fu">validate_factor</span>(<span class="fu">new_factor</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="st">&quot;a&quot;</span>))</span>
<span id="cb555-25"><a href="s3.html#cb555-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: All `x` values must be non-missing and greater than zero</span></span></code></pre></div>
<p>This validator function is called primarily for its side-effects (throwing an error if the object is invalid) so you’d expect it to invisibly return its primary input (as described in Section <a href="functions.html#invisible">6.7.2</a>). However, it’s useful for validation methods to return visibly, as we’ll see next.</p>
</div>
<div id="helpers" class="section level3" number="13.3.3">
<h3><span class="header-section-number">13.3.3</span> Helpers</h3>
<p>
</p>
<p>If you want users to construct objects from your class, you should also provide a helper method that makes their life as easy as possible. A helper should always:</p>
<ul>
<li><p>Have the same name as the class, e.g. <code>myclass()</code>.</p></li>
<li><p>Finish by calling the constructor, and the validator, if it exists.</p></li>
<li><p>Create carefully crafted error messages tailored towards an end-user.</p></li>
<li><p>Have a thoughtfully crafted user interface with carefully chosen default
values and useful conversions.</p></li>
</ul>
<p>The last bullet is the trickiest, and it’s hard to give general advice. However, there are three common patterns:</p>
<ul>
<li><p>Sometimes all the helper needs to do is coerce its inputs to the desired
type. For example, <code>new_difftime()</code> is very strict, and violates the usual
convention that you can use an integer vector wherever you can use a
double vector:</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="s3.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">new_difftime</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb556-2"><a href="s3.html#cb556-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in new_difftime(1:10): is.double(x) is not TRUE</span></span></code></pre></div>
<p>It’s not the job of the constructor to be flexible, so here we create
a helper that just coerces the input to a double.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="s3.html#cb557-1" aria-hidden="true" tabindex="-1"></a>difftime <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">double</span>(), <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>) {</span>
<span id="cb557-2"><a href="s3.html#cb557-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.double</span>(x)</span>
<span id="cb557-3"><a href="s3.html#cb557-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new_difftime</span>(x, <span class="at">units =</span> units)</span>
<span id="cb557-4"><a href="s3.html#cb557-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb557-5"><a href="s3.html#cb557-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-6"><a href="s3.html#cb557-6" aria-hidden="true" tabindex="-1"></a><span class="fu">difftime</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb557-7"><a href="s3.html#cb557-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time differences in secs</span></span>
<span id="cb557-8"><a href="s3.html#cb557-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></span></code></pre></div></li>
<li><p>Often, the most natural representation of a complex object is a string.
For example, it’s very convenient to specify factors with a character
vector. The code below shows a simple version of <code>factor()</code>: it takes a
character vector, and guesses that the levels should be the unique values.
This is not always correct (since some levels might not be seen in the
data), but it’s a useful default.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="s3.html#cb558-1" aria-hidden="true" tabindex="-1"></a>factor <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">character</span>(), <span class="at">levels =</span> <span class="fu">unique</span>(x)) {</span>
<span id="cb558-2"><a href="s3.html#cb558-2" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">match</span>(x, levels)</span>
<span id="cb558-3"><a href="s3.html#cb558-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">validate_factor</span>(<span class="fu">new_factor</span>(ind, levels))</span>
<span id="cb558-4"><a href="s3.html#cb558-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb558-5"><a href="s3.html#cb558-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-6"><a href="s3.html#cb558-6" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))</span>
<span id="cb558-7"><a href="s3.html#cb558-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] a a b</span></span>
<span id="cb558-8"><a href="s3.html#cb558-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Levels: a b</span></span></code></pre></div></li>
<li><p>Some complex objects are most naturally specified by multiple simple<br />
components. For example, I think it’s natural to construct a date-time
by supplying the individual components (year, month, day etc). That leads
me to this <code>POSIXct()</code> helper that resembles the existing <code>ISODatetime()</code>
function<a href="#fn70" class="footnote-ref" id="fnref70"><sup>70</sup></a>:</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="s3.html#cb559-1" aria-hidden="true" tabindex="-1"></a>POSIXct <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">year =</span> <span class="fu">integer</span>(), </span>
<span id="cb559-2"><a href="s3.html#cb559-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">month =</span> <span class="fu">integer</span>(), </span>
<span id="cb559-3"><a href="s3.html#cb559-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">day =</span> <span class="fu">integer</span>(), </span>
<span id="cb559-4"><a href="s3.html#cb559-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hour =</span> 0L, </span>
<span id="cb559-5"><a href="s3.html#cb559-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">minute =</span> 0L, </span>
<span id="cb559-6"><a href="s3.html#cb559-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sec =</span> <span class="dv">0</span>, </span>
<span id="cb559-7"><a href="s3.html#cb559-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tzone =</span> <span class="st">&quot;&quot;</span>) {</span>
<span id="cb559-8"><a href="s3.html#cb559-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ISOdatetime</span>(year, month, day, hour, minute, sec, <span class="at">tz =</span> tzone)</span>
<span id="cb559-9"><a href="s3.html#cb559-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb559-10"><a href="s3.html#cb559-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-11"><a href="s3.html#cb559-11" aria-hidden="true" tabindex="-1"></a><span class="fu">POSIXct</span>(<span class="dv">2020</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">tzone =</span> <span class="st">&quot;America/New_York&quot;</span>)</span>
<span id="cb559-12"><a href="s3.html#cb559-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2020-01-01 EST&quot;</span></span></code></pre></div></li>
</ul>
<p>For more complicated classes, you should feel free to go beyond these patterns to make life as easy as possible for your users.</p>
</div>
<div id="exercises-39" class="section level3" number="13.3.4">
<h3><span class="header-section-number">13.3.4</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Write a constructor for <code>data.frame</code> objects. What base type is a data
frame built on? What attributes does it use? What are the restrictions
placed on the individual elements? What about the names?</p></li>
<li><p>Enhance my <code>factor()</code> helper to have better behaviour when one or
more <code>values</code> is not found in <code>levels</code>. What does <code>base::factor()</code> do
in this situation?</p></li>
<li><p>Carefully read the source code of <code>factor()</code>. What does it do that
my constructor does not?</p></li>
<li><p>Factors have an optional “contrasts” attribute. Read the help for <code>C()</code>,
and briefly describe the purpose of the attribute. What type should it
have? Rewrite the <code>new_factor()</code> constructor to include this attribute.</p></li>
<li><p>Read the documentation for <code>utils::as.roman()</code>. How would you write a
constructor for this class? Does it need a validator? What might a helper
do?</p></li>
</ol>
</div>
</div>
<div id="s3-methods" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> Generics and methods</h2>
<p>
</p>
<p>The job of an S3 generic is to perform method dispatch, i.e. find the specific implementation for a class. Method dispatch is performed by <code>UseMethod()</code>, which every generic calls<a href="#fn71" class="footnote-ref" id="fnref71"><sup>71</sup></a>. <code>UseMethod()</code> takes two arguments: the name of the generic function (required), and the argument to use for method dispatch (optional). If you omit the second argument, it will dispatch based on the first argument, which is almost always what is desired.</p>
<p>Most generics are very simple, and consist of only a call to <code>UseMethod()</code>. Take <code>mean()</code> for example:</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="s3.html#cb560-1" aria-hidden="true" tabindex="-1"></a>mean</span>
<span id="cb560-2"><a href="s3.html#cb560-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function (x, ...) </span></span>
<span id="cb560-3"><a href="s3.html#cb560-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UseMethod(&quot;mean&quot;)</span></span>
<span id="cb560-4"><a href="s3.html#cb560-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;bytecode: 0x556e05c30d38&gt;</span></span>
<span id="cb560-5"><a href="s3.html#cb560-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: namespace:base&gt;</span></span></code></pre></div>
<p>Creating your own generic is similarly simple:</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="s3.html#cb561-1" aria-hidden="true" tabindex="-1"></a>my_new_generic <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb561-2"><a href="s3.html#cb561-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">UseMethod</span>(<span class="st">&quot;my_new_generic&quot;</span>)</span>
<span id="cb561-3"><a href="s3.html#cb561-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>(If you wonder why we have to repeat <code>my_new_generic</code> twice, think back to Section <a href="functions.html#first-class-functions">6.2.3</a>.)</p>
<p>You don’t pass any of the arguments of the generic to <code>UseMethod()</code>; it uses deep magic to pass to the method automatically. The precise process is complicated and frequently surprising, so you should avoid doing any computation in a generic. To learn the full details, carefully read the Technical Details section in <code>?UseMethod</code>.</p>
<div id="method-dispatch" class="section level3" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Method dispatch</h3>
<p>
</p>
<p>How does <code>UseMethod()</code> work? It basically creates a vector of method names, <code>paste0("generic", ".", c(class(x), "default"))</code>, and then looks for each potential method in turn. We can see this in action with <code>sloop::s3_dispatch()</code>. You give it a call to an S3 generic, and it lists all the possible methods. For example, what method is called when you print a <code>Date</code> object?</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="s3.html#cb562-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb562-2"><a href="s3.html#cb562-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">print</span>(x))</span>
<span id="cb562-3"><a href="s3.html#cb562-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; print.Date</span></span>
<span id="cb562-4"><a href="s3.html#cb562-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  * print.default</span></span></code></pre></div>
<p>The output here is simple:</p>
<ul>
<li><code>=&gt;</code> indicates the method that is called, here <code>print.Date()</code></li>
<li><code>*</code> indicates a method that is defined, but not called, here <code>print.default()</code>.</li>
</ul>
<p>The “default” class is a special <strong>pseudo-class</strong>. This is not a real class, but is included to make it possible to define a standard fallback that is found whenever a class-specific method is not available.</p>
<p>The essence of method dispatch is quite simple, but as the chapter proceeds you’ll see it get progressively more complicated to encompass inheritance, base types, internal generics, and group generics. The code below shows a couple of more complicated cases which we’ll come back to in Sections <a href="r6.html#inheritance">14.2.4</a> and <a href="s3.html#s3-dispatch">13.7</a>.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="s3.html#cb563-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb563-2"><a href="s3.html#cb563-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">mean</span>(x))</span>
<span id="cb563-3"><a href="s3.html#cb563-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mean.matrix</span></span>
<span id="cb563-4"><a href="s3.html#cb563-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mean.integer</span></span>
<span id="cb563-5"><a href="s3.html#cb563-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mean.numeric</span></span>
<span id="cb563-6"><a href="s3.html#cb563-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; mean.default</span></span>
<span id="cb563-7"><a href="s3.html#cb563-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-8"><a href="s3.html#cb563-8" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">sum</span>(<span class="fu">Sys.time</span>()))</span>
<span id="cb563-9"><a href="s3.html#cb563-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sum.POSIXct</span></span>
<span id="cb563-10"><a href="s3.html#cb563-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sum.POSIXt</span></span>
<span id="cb563-11"><a href="s3.html#cb563-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sum.default</span></span>
<span id="cb563-12"><a href="s3.html#cb563-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; Summary.POSIXct</span></span>
<span id="cb563-13"><a href="s3.html#cb563-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Summary.POSIXt</span></span>
<span id="cb563-14"><a href="s3.html#cb563-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Summary.default</span></span>
<span id="cb563-15"><a href="s3.html#cb563-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -&gt; sum (internal)</span></span></code></pre></div>
</div>
<div id="finding-methods" class="section level3" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Finding methods</h3>
<p></p>
<p><code>sloop::s3_dispatch()</code> lets you find the specific method used for a single call. What if you want to find all methods defined for a generic or associated with a class? That’s the job of <code>sloop::s3_methods_generic()</code> and <code>sloop::s3_methods_class()</code>:</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="s3.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_methods_generic</span>(<span class="st">&quot;mean&quot;</span>)</span>
<span id="cb564-2"><a href="s3.html#cb564-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 7 × 4</span></span>
<span id="cb564-3"><a href="s3.html#cb564-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   generic class      visible source             </span></span>
<span id="cb564-4"><a href="s3.html#cb564-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;lgl&gt;   &lt;chr&gt;              </span></span>
<span id="cb564-5"><a href="s3.html#cb564-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 mean    Date       TRUE    base               </span></span>
<span id="cb564-6"><a href="s3.html#cb564-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 mean    default    TRUE    base               </span></span>
<span id="cb564-7"><a href="s3.html#cb564-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 mean    difftime   TRUE    base               </span></span>
<span id="cb564-8"><a href="s3.html#cb564-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 mean    POSIXct    TRUE    base               </span></span>
<span id="cb564-9"><a href="s3.html#cb564-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 mean    POSIXlt    TRUE    base               </span></span>
<span id="cb564-10"><a href="s3.html#cb564-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 mean    quosure    FALSE   registered S3method</span></span>
<span id="cb564-11"><a href="s3.html#cb564-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 mean    vctrs_vctr FALSE   registered S3method</span></span>
<span id="cb564-12"><a href="s3.html#cb564-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-13"><a href="s3.html#cb564-13" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_methods_class</span>(<span class="st">&quot;ordered&quot;</span>)</span>
<span id="cb564-14"><a href="s3.html#cb564-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 4</span></span>
<span id="cb564-15"><a href="s3.html#cb564-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   generic       class   visible source             </span></span>
<span id="cb564-16"><a href="s3.html#cb564-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;   &lt;lgl&gt;   &lt;chr&gt;              </span></span>
<span id="cb564-17"><a href="s3.html#cb564-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 as.data.frame ordered TRUE    base               </span></span>
<span id="cb564-18"><a href="s3.html#cb564-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Ops           ordered TRUE    base               </span></span>
<span id="cb564-19"><a href="s3.html#cb564-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 relevel       ordered FALSE   registered S3method</span></span>
<span id="cb564-20"><a href="s3.html#cb564-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Summary       ordered TRUE    base</span></span></code></pre></div>
</div>
<div id="s3-arguments" class="section level3" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> Creating methods</h3>
<p>
</p>
<p>There are two wrinkles to be aware of when you create a new method:</p>
<ul>
<li><p>First, you should only ever write a method if you own the generic or the
class. R will allow you to define a method even if you don’t, but it is
exceedingly bad manners. Instead, work with the author of either the
generic or the class to add the method in their code.</p></li>
<li><p>A method must have the same arguments as its generic. This is enforced in
packages by <code>R CMD check</code>, but it’s good practice even if you’re not
creating a package.</p>
<p>There is one exception to this rule: if the generic has <code>...</code>, the method
can contain a superset of the arguments. This allows methods to take
arbitrary additional arguments. The downside of using <code>...</code>, however, is
that any misspelled arguments will be silently swallowed<a href="#fn72" class="footnote-ref" id="fnref72"><sup>72</sup></a>,
as mentioned in Section <a href="functions.html#fun-dot-dot-dot">6.6</a>.</p></li>
</ul>
</div>
<div id="exercises-40" class="section level3" number="13.4.4">
<h3><span class="header-section-number">13.4.4</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Read the source code for <code>t()</code> and <code>t.test()</code> and confirm that
<code>t.test()</code> is an S3 generic and not an S3 method. What happens if
you create an object with class <code>test</code> and call <code>t()</code> with it? Why?</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="s3.html#cb565-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">class =</span> <span class="st">&quot;test&quot;</span>)</span>
<span id="cb565-2"><a href="s3.html#cb565-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(x)</span></code></pre></div></li>
<li><p>What generics does the <code>table</code> class have methods for?</p></li>
<li><p>What generics does the <code>ecdf</code> class have methods for?</p></li>
<li><p>Which base generic has the greatest number of defined methods?</p></li>
<li><p>Carefully read the documentation for <code>UseMethod()</code> and explain why the
following code returns the results that it does. What two usual rules
of function evaluation does <code>UseMethod()</code> violate?</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="s3.html#cb566-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb566-2"><a href="s3.html#cb566-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb566-3"><a href="s3.html#cb566-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb566-4"><a href="s3.html#cb566-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">UseMethod</span>(<span class="st">&quot;g&quot;</span>)</span>
<span id="cb566-5"><a href="s3.html#cb566-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb566-6"><a href="s3.html#cb566-6" aria-hidden="true" tabindex="-1"></a>g.default <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb566-7"><a href="s3.html#cb566-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-8"><a href="s3.html#cb566-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb566-9"><a href="s3.html#cb566-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb566-10"><a href="s3.html#cb566-10" aria-hidden="true" tabindex="-1"></a><span class="fu">g</span>(x)</span>
<span id="cb566-11"><a href="s3.html#cb566-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  x  y </span></span>
<span id="cb566-12"><a href="s3.html#cb566-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 10</span></span></code></pre></div></li>
<li><p>What are the arguments to <code>[</code>? Why is this a hard question to answer?</p></li>
</ol>
</div>
</div>
<div id="object-styles" class="section level2" number="13.5">
<h2><span class="header-section-number">13.5</span> Object styles</h2>
<p></p>
<p>So far I’ve focussed on vector style classes like <code>Date</code> and <code>factor</code>. These have the key property that <code>length(x)</code> represents the number of observations in the vector. There are three variants that do not have this property:</p>
<ul>
<li><p>Record style objects use a list of equal-length vectors to represent
individual components of the object. The best example of this is <code>POSIXlt</code>,
which underneath the hood is a list of 11 date-time components like year,
month, and day. Record style classes override <code>length()</code> and subsetting
methods to conceal this implementation detail.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="s3.html#cb567-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(<span class="fu">ISOdatetime</span>(<span class="dv">2020</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb567-2"><a href="s3.html#cb567-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb567-3"><a href="s3.html#cb567-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2020-01-01 00:00:01 UTC&quot; &quot;2020-01-01 00:00:02 UTC&quot;</span></span>
<span id="cb567-4"><a href="s3.html#cb567-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3] &quot;2020-01-01 00:00:03 UTC&quot;</span></span>
<span id="cb567-5"><a href="s3.html#cb567-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-6"><a href="s3.html#cb567-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)</span>
<span id="cb567-7"><a href="s3.html#cb567-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb567-8"><a href="s3.html#cb567-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unclass</span>(x))</span>
<span id="cb567-9"><a href="s3.html#cb567-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 11</span></span>
<span id="cb567-10"><a href="s3.html#cb567-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-11"><a href="s3.html#cb567-11" aria-hidden="true" tabindex="-1"></a>x[[<span class="dv">1</span>]] <span class="co"># the first date time</span></span>
<span id="cb567-12"><a href="s3.html#cb567-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2020-01-01 00:00:01 UTC&quot;</span></span>
<span id="cb567-13"><a href="s3.html#cb567-13" aria-hidden="true" tabindex="-1"></a><span class="fu">unclass</span>(x)[[<span class="dv">1</span>]] <span class="co"># the first component, the number of seconds</span></span>
<span id="cb567-14"><a href="s3.html#cb567-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3</span></span></code></pre></div></li>
<li><p>Data frames are similar to record style objects in that both use lists of
equal length vectors. However, data frames are conceptually two dimensional,
and the individual components are readily exposed to the user. The number of
observations is the number of rows, not the length:</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="s3.html#cb568-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb568-2"><a href="s3.html#cb568-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)</span>
<span id="cb568-3"><a href="s3.html#cb568-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb568-4"><a href="s3.html#cb568-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(x)</span>
<span id="cb568-5"><a href="s3.html#cb568-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 100</span></span></code></pre></div></li>
<li><p>Scalar objects typically use a list to represent a single thing.
For example, an <code>lm</code> object is a list of length 12 but it represents one
model.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="s3.html#cb569-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb569-2"><a href="s3.html#cb569-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(mod)</span>
<span id="cb569-3"><a href="s3.html#cb569-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 12</span></span></code></pre></div>
<p>Scalar objects can also be built on top of functions, calls, and
environments<a href="#fn73" class="footnote-ref" id="fnref73"><sup>73</sup></a>. This is less generally useful, but you can see
applications in <code>stats::ecdf()</code>, R6 (Chapter <a href="r6.html#r6">14</a>), and
<code>rlang::quo()</code> (Chapter <a href="quasiquotation.html#quasiquotation">19</a>).
</p></li>
</ul>
<p>Unfortunately, describing the appropriate use of each of these object styles is beyond the scope of this book. However, you can learn more from the documentation of the vctrs package (<a href="https://vctrs.r-lib.org" class="uri">https://vctrs.r-lib.org</a>); the package also provides constructors and helpers that make implementation of the different styles easier.</p>
<div id="exercises-41" class="section level3" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Categorise the objects returned by <code>lm()</code>, <code>factor()</code>, <code>table()</code>,
<code>as.Date()</code>, <code>as.POSIXct()</code> <code>ecdf()</code>, <code>ordered()</code>, <code>I()</code> into the
styles described above.</p></li>
<li><p>What would a constructor function for <code>lm</code> objects, <code>new_lm()</code>, look like?
Use <code>?lm</code> and experimentation to figure out the required fields and their
types.</p></li>
</ol>
</div>
</div>
<div id="s3-inheritance" class="section level2" number="13.6">
<h2><span class="header-section-number">13.6</span> Inheritance</h2>
<p>

</p>
<p>S3 classes can share behaviour through a mechanism called <strong>inheritance</strong>. Inheritance is powered by three ideas:</p>
<ul>
<li><p>The class can be a character <em>vector</em>. For example, the <code>ordered</code> and
<code>POSIXct</code> classes have two components in their class:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="s3.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">ordered</span>(<span class="st">&quot;x&quot;</span>))</span>
<span id="cb570-2"><a href="s3.html#cb570-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;ordered&quot; &quot;factor&quot;</span></span>
<span id="cb570-3"><a href="s3.html#cb570-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb570-4"><a href="s3.html#cb570-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</span></span></code></pre></div></li>
<li><p>If a method is not found for the class in the first element of the
vector, R looks for a method for the second class (and so on):</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="s3.html#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">print</span>(<span class="fu">ordered</span>(<span class="st">&quot;x&quot;</span>)))</span>
<span id="cb571-2"><a href="s3.html#cb571-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    print.ordered</span></span>
<span id="cb571-3"><a href="s3.html#cb571-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; print.factor</span></span>
<span id="cb571-4"><a href="s3.html#cb571-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  * print.default</span></span>
<span id="cb571-5"><a href="s3.html#cb571-5" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">print</span>(<span class="fu">Sys.time</span>()))</span>
<span id="cb571-6"><a href="s3.html#cb571-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; print.POSIXct</span></span>
<span id="cb571-7"><a href="s3.html#cb571-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    print.POSIXt</span></span>
<span id="cb571-8"><a href="s3.html#cb571-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  * print.default</span></span></code></pre></div></li>
<li><p>A method can delegate work by calling <code>NextMethod()</code>. We’ll come back to
that very shortly; for now, note that <code>s3_dispatch()</code> reports delegation
with <code>-&gt;</code>.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="s3.html#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">ordered</span>(<span class="st">&quot;x&quot;</span>)[<span class="dv">1</span>])</span>
<span id="cb572-2"><a href="s3.html#cb572-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.ordered</span></span>
<span id="cb572-3"><a href="s3.html#cb572-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; [.factor</span></span>
<span id="cb572-4"><a href="s3.html#cb572-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.default</span></span>
<span id="cb572-5"><a href="s3.html#cb572-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -&gt; [ (internal)</span></span>
<span id="cb572-6"><a href="s3.html#cb572-6" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">Sys.time</span>()[<span class="dv">1</span>])</span>
<span id="cb572-7"><a href="s3.html#cb572-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; [.POSIXct</span></span>
<span id="cb572-8"><a href="s3.html#cb572-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.POSIXt</span></span>
<span id="cb572-9"><a href="s3.html#cb572-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.default</span></span>
<span id="cb572-10"><a href="s3.html#cb572-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -&gt; [ (internal)</span></span></code></pre></div></li>
</ul>
<p>Before we continue we need a bit of vocabulary to describe the relationship between the classes that appear together in a class vector. We’ll say that <code>ordered</code> is a <strong>subclass</strong> of <code>factor</code> because it always appears before it in the class vector, and, conversely, we’ll say <code>factor</code> is a <strong>superclass</strong> of <code>ordered</code>.</p>
<p>S3 imposes no restrictions on the relationship between sub- and superclasses but your life will be easier if you impose some. I recommend that you adhere to two simple principles when creating a subclass:</p>
<ul>
<li><p>The base type of the subclass should be that same as the superclass.</p></li>
<li><p>The attributes of the subclass should be a superset of the attributes
of the superclass.</p></li>
</ul>
<p><code>POSIXt</code> does not adhere to these principles because <code>POSIXct</code> has type double, and <code>POSIXlt</code> has type list. This means that <code>POSIXt</code> is not a superclass, and illustrates that it’s quite possible to use the S3 inheritance system to implement other styles of code sharing (here <code>POSIXt</code> plays a role more like an interface), but you’ll need to figure out safe conventions yourself.
</p>
<div id="nextmethod" class="section level3" number="13.6.1">
<h3><span class="header-section-number">13.6.1</span> <code>NextMethod()</code></h3>
<p><code>NextMethod()</code> is the hardest part of inheritance to understand, so we’ll start with a concrete example for the most common use case: <code>[</code>. We’ll start by creating a simple toy class: a <code>secret</code> class that hides its output when printed:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="s3.html#cb573-1" aria-hidden="true" tabindex="-1"></a>new_secret <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">double</span>()) {</span>
<span id="cb573-2"><a href="s3.html#cb573-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.double</span>(x))</span>
<span id="cb573-3"><a href="s3.html#cb573-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">structure</span>(x, <span class="at">class =</span> <span class="st">&quot;secret&quot;</span>)</span>
<span id="cb573-4"><a href="s3.html#cb573-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb573-5"><a href="s3.html#cb573-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-6"><a href="s3.html#cb573-6" aria-hidden="true" tabindex="-1"></a>print.secret <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb573-7"><a href="s3.html#cb573-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">strrep</span>(<span class="st">&quot;x&quot;</span>, <span class="fu">nchar</span>(x)))</span>
<span id="cb573-8"><a href="s3.html#cb573-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(x)</span>
<span id="cb573-9"><a href="s3.html#cb573-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb573-10"><a href="s3.html#cb573-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-11"><a href="s3.html#cb573-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">new_secret</span>(<span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">456</span>))</span>
<span id="cb573-12"><a href="s3.html#cb573-12" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb573-13"><a href="s3.html#cb573-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;xx&quot;  &quot;x&quot;   &quot;xxx&quot;</span></span></code></pre></div>
<p>This works, but the default <code>[</code> method doesn’t preserve the class:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="s3.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(x[<span class="dv">1</span>])</span>
<span id="cb574-2"><a href="s3.html#cb574-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.secret</span></span>
<span id="cb574-3"><a href="s3.html#cb574-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.default</span></span>
<span id="cb574-4"><a href="s3.html#cb574-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; [ (internal)</span></span>
<span id="cb574-5"><a href="s3.html#cb574-5" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]</span>
<span id="cb574-6"><a href="s3.html#cb574-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 15</span></span></code></pre></div>
<p>To fix this, we need to provide a <code>[.secret</code> method. How could we implement this method? The naive approach won’t work because we’ll get stuck in an infinite loop:</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="s3.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">[.secret</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) {</span>
<span id="cb575-2"><a href="s3.html#cb575-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new_secret</span>(x[i])</span>
<span id="cb575-3"><a href="s3.html#cb575-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Instead, we need some way to call the underlying <code>[</code> code, i.e. the implementation that would get called if we didn’t have a <code>[.secret</code> method. One approach would be to <code>unclass()</code> the object:</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="s3.html#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">[.secret</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) {</span>
<span id="cb576-2"><a href="s3.html#cb576-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">unclass</span>(x)</span>
<span id="cb576-3"><a href="s3.html#cb576-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new_secret</span>(x[i])</span>
<span id="cb576-4"><a href="s3.html#cb576-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb576-5"><a href="s3.html#cb576-5" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]</span>
<span id="cb576-6"><a href="s3.html#cb576-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;xx&quot;</span></span></code></pre></div>
<p>This works, but is inefficient because it creates a copy of <code>x</code>. A better approach is to use <code>NextMethod()</code>, which concisely solves the problem of delegating to the method that would have been called if <code>[.secret</code> didn’t exist:</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="s3.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">[.secret</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) {</span>
<span id="cb577-2"><a href="s3.html#cb577-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new_secret</span>(<span class="fu">NextMethod</span>())</span>
<span id="cb577-3"><a href="s3.html#cb577-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb577-4"><a href="s3.html#cb577-4" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]</span>
<span id="cb577-5"><a href="s3.html#cb577-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;xx&quot;</span></span></code></pre></div>
<p>We can see what’s going on with <code>sloop::s3_dispatch()</code>:</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="s3.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(x[<span class="dv">1</span>])</span>
<span id="cb578-2"><a href="s3.html#cb578-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; [.secret</span></span>
<span id="cb578-3"><a href="s3.html#cb578-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.default</span></span>
<span id="cb578-4"><a href="s3.html#cb578-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -&gt; [ (internal)</span></span></code></pre></div>
<p>The <code>=&gt;</code> indicates that <code>[.secret</code> is called, but that <code>NextMethod()</code> delegates work to the underlying internal <code>[</code> method, as shown by the <code>-&gt;</code>.</p>
<p>As with <code>UseMethod()</code>, the precise semantics of <code>NextMethod()</code> are complex. In particular, it tracks the list of potential next methods with a special variable, which means that modifying the object that’s being dispatched upon will have no impact on which method gets called next.</p>
</div>
<div id="s3-subclassing" class="section level3" number="13.6.2">
<h3><span class="header-section-number">13.6.2</span> Allowing subclassing</h3>
<p></p>
<p>When you create a class, you need to decide if you want to allow subclasses, because it requires some changes to the constructor and careful thought in your methods.</p>
<p>To allow subclasses, the parent constructor needs to have <code>...</code> and <code>class</code> arguments:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="s3.html#cb579-1" aria-hidden="true" tabindex="-1"></a>new_secret <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ..., <span class="at">class =</span> <span class="fu">character</span>()) {</span>
<span id="cb579-2"><a href="s3.html#cb579-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.double</span>(x))</span>
<span id="cb579-3"><a href="s3.html#cb579-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb579-4"><a href="s3.html#cb579-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">structure</span>(</span>
<span id="cb579-5"><a href="s3.html#cb579-5" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb579-6"><a href="s3.html#cb579-6" aria-hidden="true" tabindex="-1"></a>    ...,</span>
<span id="cb579-7"><a href="s3.html#cb579-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">class =</span> <span class="fu">c</span>(class, <span class="st">&quot;secret&quot;</span>)</span>
<span id="cb579-8"><a href="s3.html#cb579-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb579-9"><a href="s3.html#cb579-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then the subclass constructor can just call to the parent class constructor with additional arguments as needed. For example, imagine we want to create a supersecret class which also hides the number of characters:</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="s3.html#cb580-1" aria-hidden="true" tabindex="-1"></a>new_supersecret <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb580-2"><a href="s3.html#cb580-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new_secret</span>(x, <span class="at">class =</span> <span class="st">&quot;supersecret&quot;</span>)</span>
<span id="cb580-3"><a href="s3.html#cb580-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb580-4"><a href="s3.html#cb580-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-5"><a href="s3.html#cb580-5" aria-hidden="true" tabindex="-1"></a>print.supersecret <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb580-6"><a href="s3.html#cb580-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">rep</span>(<span class="st">&quot;xxxxx&quot;</span>, <span class="fu">length</span>(x)))</span>
<span id="cb580-7"><a href="s3.html#cb580-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(x)</span>
<span id="cb580-8"><a href="s3.html#cb580-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb580-9"><a href="s3.html#cb580-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-10"><a href="s3.html#cb580-10" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">new_supersecret</span>(<span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">456</span>))</span>
<span id="cb580-11"><a href="s3.html#cb580-11" aria-hidden="true" tabindex="-1"></a>x2</span>
<span id="cb580-12"><a href="s3.html#cb580-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;xxxxx&quot; &quot;xxxxx&quot; &quot;xxxxx&quot;</span></span></code></pre></div>
<p>To allow inheritance, you also need to think carefully about your methods, as you can no longer use the constructor. If you do, the method will always return the same class, regardless of the input. This forces whoever makes a subclass to do a lot of extra work.</p>
<p>Concretely, this means we need to revise the <code>[.secret</code> method. Currently it always returns a <code>secret()</code>, even when given a supersecret:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="s3.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">[.secret</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb581-2"><a href="s3.html#cb581-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new_secret</span>(<span class="fu">NextMethod</span>())</span>
<span id="cb581-3"><a href="s3.html#cb581-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb581-4"><a href="s3.html#cb581-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-5"><a href="s3.html#cb581-5" aria-hidden="true" tabindex="-1"></a>x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb581-6"><a href="s3.html#cb581-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;xx&quot;  &quot;x&quot;   &quot;xxx&quot;</span></span></code></pre></div>
<p>We want to make sure that <code>[.secret</code> returns the same class as <code>x</code> even if it’s a subclass. As far as I can tell, there is no way to solve this problem using base R alone. Instead, you’ll need to use the vctrs package, which provides a solution in the form of the <code>vctrs::vec_restore()</code> generic. This generic takes two inputs: an object which has lost subclass information, and a template object to use for restoration.</p>
<p>Typically <code>vec_restore()</code> methods are quite simple: you just call the constructor with appropriate arguments:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="s3.html#cb582-1" aria-hidden="true" tabindex="-1"></a>vec_restore.secret <span class="ot">&lt;-</span> <span class="cf">function</span>(x, to, ...) <span class="fu">new_secret</span>(x)</span>
<span id="cb582-2"><a href="s3.html#cb582-2" aria-hidden="true" tabindex="-1"></a>vec_restore.supersecret <span class="ot">&lt;-</span> <span class="cf">function</span>(x, to, ...) <span class="fu">new_supersecret</span>(x)</span></code></pre></div>
<p>(If your class has attributes, you’ll need to pass them from <code>to</code> into the constructor.)</p>
<p>Now we can use <code>vec_restore()</code> in the <code>[.secret</code> method:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="s3.html#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">[.secret</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb583-2"><a href="s3.html#cb583-2" aria-hidden="true" tabindex="-1"></a>  vctrs<span class="sc">::</span><span class="fu">vec_restore</span>(<span class="fu">NextMethod</span>(), x)</span>
<span id="cb583-3"><a href="s3.html#cb583-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb583-4"><a href="s3.html#cb583-4" aria-hidden="true" tabindex="-1"></a>x2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb583-5"><a href="s3.html#cb583-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;xxxxx&quot; &quot;xxxxx&quot; &quot;xxxxx&quot;</span></span></code></pre></div>
<p>(I only fully understood this issue quite recently, so at time of writing it is not used in the tidyverse. Hopefully by the time you’re reading this, it will have rolled out, making it much easier to (e.g.) subclass tibbles.)</p>
<p>If you build your class using the tools provided by the vctrs package, <code>[</code> will gain this behaviour automatically. You will only need to provide your own <code>[</code> method if you use attributes that depend on the data or want non-standard subsetting behaviour. See <code>?vctrs::new_vctr</code> for details.</p>
</div>
<div id="exercises-42" class="section level3" number="13.6.3">
<h3><span class="header-section-number">13.6.3</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>How does <code>[.Date</code> support subclasses? How does it fail to support
subclasses?</p></li>
<li><p>R has two classes for representing date time data, <code>POSIXct</code> and
<code>POSIXlt</code>, which both inherit from <code>POSIXt</code>. Which generics have
different behaviours for the two classes? Which generics share the same
behaviour?</p></li>
<li><p>What do you expect this code to return? What does it actually return?
Why?</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="s3.html#cb584-1" aria-hidden="true" tabindex="-1"></a>generic2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">UseMethod</span>(<span class="st">&quot;generic2&quot;</span>)</span>
<span id="cb584-2"><a href="s3.html#cb584-2" aria-hidden="true" tabindex="-1"></a>generic2.a1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="st">&quot;a1&quot;</span></span>
<span id="cb584-3"><a href="s3.html#cb584-3" aria-hidden="true" tabindex="-1"></a>generic2.a2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="st">&quot;a2&quot;</span></span>
<span id="cb584-4"><a href="s3.html#cb584-4" aria-hidden="true" tabindex="-1"></a>generic2.b <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb584-5"><a href="s3.html#cb584-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>(x) <span class="ot">&lt;-</span> <span class="st">&quot;a1&quot;</span></span>
<span id="cb584-6"><a href="s3.html#cb584-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">NextMethod</span>()</span>
<span id="cb584-7"><a href="s3.html#cb584-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb584-8"><a href="s3.html#cb584-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-9"><a href="s3.html#cb584-9" aria-hidden="true" tabindex="-1"></a><span class="fu">generic2</span>(<span class="fu">structure</span>(<span class="fu">list</span>(), <span class="at">class =</span> <span class="fu">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;a2&quot;</span>)))</span></code></pre></div></li>
</ol>
</div>
</div>
<div id="s3-dispatch" class="section level2" number="13.7">
<h2><span class="header-section-number">13.7</span> Dispatch details</h2>
<p></p>
<p>This chapter concludes with a few additional details about method dispatch. It is safe to skip these details if you’re new to S3.</p>
<div id="implicit-class" class="section level3" number="13.7.1">
<h3><span class="header-section-number">13.7.1</span> S3 and base types</h3>
<p>
</p>
<p>What happens when you call an S3 generic with a base object, i.e. an object with no class? You might think it would dispatch on what <code>class()</code> returns:</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="s3.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb585-2"><a href="s3.html#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;matrix&quot; &quot;array&quot;</span></span></code></pre></div>
<p>But unfortunately dispatch actually occurs on the <strong>implicit class</strong>, which has three components:</p>
<ul>
<li>The string “array” or “matrix” if the object has dimensions</li>
<li>The result of <code>typeof()</code> with a few minor tweaks</li>
<li>The string “numeric” if object is “integer” or “double”</li>
</ul>
<p>There is no base function that will compute the implicit class, but you can use <code>sloop::s3_class()</code></p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="s3.html#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_class</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb586-2"><a href="s3.html#cb586-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;matrix&quot;  &quot;integer&quot; &quot;numeric&quot;</span></span></code></pre></div>
<p>This is used by <code>s3_dispatch()</code>:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="s3.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">print</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)))</span>
<span id="cb587-2"><a href="s3.html#cb587-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    print.matrix</span></span>
<span id="cb587-3"><a href="s3.html#cb587-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    print.integer</span></span>
<span id="cb587-4"><a href="s3.html#cb587-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    print.numeric</span></span>
<span id="cb587-5"><a href="s3.html#cb587-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; print.default</span></span></code></pre></div>
<p>This means that the <code>class()</code> of an object does not uniquely determine its dispatch:</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="s3.html#cb588-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb588-2"><a href="s3.html#cb588-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x1)</span>
<span id="cb588-3"><a href="s3.html#cb588-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;integer&quot;</span></span>
<span id="cb588-4"><a href="s3.html#cb588-4" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">mean</span>(x1))</span>
<span id="cb588-5"><a href="s3.html#cb588-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mean.integer</span></span>
<span id="cb588-6"><a href="s3.html#cb588-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mean.numeric</span></span>
<span id="cb588-7"><a href="s3.html#cb588-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; mean.default</span></span>
<span id="cb588-8"><a href="s3.html#cb588-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-9"><a href="s3.html#cb588-9" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">structure</span>(x1, <span class="at">class =</span> <span class="st">&quot;integer&quot;</span>)</span>
<span id="cb588-10"><a href="s3.html#cb588-10" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x2)</span>
<span id="cb588-11"><a href="s3.html#cb588-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;integer&quot;</span></span>
<span id="cb588-12"><a href="s3.html#cb588-12" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">mean</span>(x2))</span>
<span id="cb588-13"><a href="s3.html#cb588-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mean.integer</span></span>
<span id="cb588-14"><a href="s3.html#cb588-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; mean.default</span></span></code></pre></div>
</div>
<div id="internal-generics" class="section level3" number="13.7.2">
<h3><span class="header-section-number">13.7.2</span> Internal generics</h3>
<p></p>
<p>Some base functions, like <code>[</code>, <code>sum()</code>, and <code>cbind()</code>, are called <strong>internal generics</strong> because they don’t call <code>UseMethod()</code> but instead call the C functions <code>DispatchGroup()</code> or <code>DispatchOrEval()</code>. <code>s3_dispatch()</code> shows internal generics by including the name of the generic followed by <code>(internal)</code>:</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="s3.html#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">Sys.time</span>()[<span class="dv">1</span>])</span>
<span id="cb589-2"><a href="s3.html#cb589-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; [.POSIXct</span></span>
<span id="cb589-3"><a href="s3.html#cb589-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.POSIXt</span></span>
<span id="cb589-4"><a href="s3.html#cb589-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [.default</span></span>
<span id="cb589-5"><a href="s3.html#cb589-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -&gt; [ (internal)</span></span></code></pre></div>
<p>For performance reasons, internal generics do not dispatch to methods unless the class attribute has been set, which means that internal generics do not use the implicit class. Again, if you’re ever confused about method dispatch, you can rely on <code>s3_dispatch()</code>.</p>
</div>
<div id="group-generics" class="section level3" number="13.7.3">
<h3><span class="header-section-number">13.7.3</span> Group generics</h3>
<p>
</p>
<p>Group generics are the most complicated part of S3 method dispatch because they involve both <code>NextMethod()</code> and internal generics. Like internal generics, they only exist in base R, and you cannot define your own group generic.</p>
<p>There are four group generics:</p>
<ul>
<li><p><strong>Math</strong>: <code>abs()</code>, <code>sign()</code>, <code>sqrt()</code>, <code>floor()</code>, <code>cos()</code>, <code>sin()</code>, <code>log()</code>,
and more (see <code>?Math</code> for the complete list).</p></li>
<li><p><strong>Ops</strong>: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code>, <code>%%</code>, <code>%/%</code>, <code>&amp;</code>, <code>|</code>, <code>!</code>, <code>==</code>, <code>!=</code>, <code>&lt;</code>,
<code>&lt;=</code>, <code>&gt;=</code>, and <code>&gt;</code>.</p></li>
<li><p><strong>Summary</strong>: <code>all()</code>, <code>any()</code>, <code>sum()</code>, <code>prod()</code>, <code>min()</code>, <code>max()</code>, and
<code>range()</code>.</p></li>
<li><p><strong>Complex</strong>: <code>Arg()</code>, <code>Conj()</code>, <code>Im()</code>, <code>Mod()</code>, <code>Re()</code>.</p></li>
</ul>
<p>Defining a single group generic for your class overrides the default behaviour for all of the members of the group. Methods for group generics are looked for only if the methods for the specific generic do not exist:</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="s3.html#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">sum</span>(<span class="fu">Sys.time</span>()))</span>
<span id="cb590-2"><a href="s3.html#cb590-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sum.POSIXct</span></span>
<span id="cb590-3"><a href="s3.html#cb590-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sum.POSIXt</span></span>
<span id="cb590-4"><a href="s3.html#cb590-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sum.default</span></span>
<span id="cb590-5"><a href="s3.html#cb590-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; Summary.POSIXct</span></span>
<span id="cb590-6"><a href="s3.html#cb590-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Summary.POSIXt</span></span>
<span id="cb590-7"><a href="s3.html#cb590-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Summary.default</span></span>
<span id="cb590-8"><a href="s3.html#cb590-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -&gt; sum (internal)</span></span></code></pre></div>
<p>Most group generics involve a call to <code>NextMethod()</code>. For example, take <code>difftime()</code> objects. If you look at the method dispatch for <code>abs()</code>, you’ll see there’s a <code>Math</code> group generic defined.</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="s3.html#cb591-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.difftime</span>(<span class="dv">10</span>, <span class="at">units =</span> <span class="st">&quot;mins&quot;</span>)</span>
<span id="cb591-2"><a href="s3.html#cb591-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">abs</span>(y))</span>
<span id="cb591-3"><a href="s3.html#cb591-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    abs.difftime</span></span>
<span id="cb591-4"><a href="s3.html#cb591-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    abs.default</span></span>
<span id="cb591-5"><a href="s3.html#cb591-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; Math.difftime</span></span>
<span id="cb591-6"><a href="s3.html#cb591-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Math.default</span></span>
<span id="cb591-7"><a href="s3.html#cb591-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -&gt; abs (internal)</span></span></code></pre></div>
<p><code>Math.difftime</code> basically looks like this:</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="s3.html#cb592-1" aria-hidden="true" tabindex="-1"></a>Math.difftime <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb592-2"><a href="s3.html#cb592-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">new_difftime</span>(<span class="fu">NextMethod</span>(), <span class="at">units =</span> <span class="fu">attr</span>(x, <span class="st">&quot;units&quot;</span>))</span>
<span id="cb592-3"><a href="s3.html#cb592-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>It dispatches to the next method, here the internal default, to perform the actual computation, then restore the class and attributes. (To better support subclasses of <code>difftime</code> this would need to call <code>vec_restore()</code>, as described in Section <a href="s3.html#s3-subclassing">13.6.2</a>.)</p>
<p>Inside a group generic function a special variable <code>.Generic</code> provides the actual generic function called. This can be useful when producing error messages, and can sometimes be useful if you need to manually re-call the generic with different arguments.</p>
</div>
<div id="double-dispatch" class="section level3" number="13.7.4">
<h3><span class="header-section-number">13.7.4</span> Double dispatch</h3>
<p>
</p>
<p>Generics in the Ops group, which includes the two-argument arithmetic and Boolean operators like <code>-</code> and <code>&amp;</code>, implement a special type of method dispatch. They dispatch on the type of <em>both</em> of the arguments, which is called <strong>double dispatch</strong>. This is necessary to preserve the commutative property of many operators, i.e. <code>a + b</code> should equal <code>b + a</code>. Take the following simple example:</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="s3.html#cb593-1" aria-hidden="true" tabindex="-1"></a>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2017-01-01&quot;</span>)</span>
<span id="cb593-2"><a href="s3.html#cb593-2" aria-hidden="true" tabindex="-1"></a>integer <span class="ot">&lt;-</span> 1L</span>
<span id="cb593-3"><a href="s3.html#cb593-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-4"><a href="s3.html#cb593-4" aria-hidden="true" tabindex="-1"></a>date <span class="sc">+</span> integer</span>
<span id="cb593-5"><a href="s3.html#cb593-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2017-01-02&quot;</span></span>
<span id="cb593-6"><a href="s3.html#cb593-6" aria-hidden="true" tabindex="-1"></a>integer <span class="sc">+</span> date</span>
<span id="cb593-7"><a href="s3.html#cb593-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2017-01-02&quot;</span></span></code></pre></div>
<p>If <code>+</code> dispatched only on the first argument, it would return different values for the two cases. To overcome this problem, generics in the Ops group use a slightly different strategy from usual. Rather than doing a single method dispatch, they do two, one for each input. There are three possible outcomes of this lookup:</p>
<ul>
<li><p>The methods are the same, so it doesn’t matter which method is used.</p></li>
<li><p>The methods are different, and R falls back to the internal method with
a warning.</p></li>
<li><p>One method is internal, in which case R calls the other method.</p></li>
</ul>
<p>This approach is error prone so if you want to implement robust double dispatch for algebraic operators, I recommend using the vctrs package. See <code>?vctrs::vec_arith</code> for details.</p>
</div>
<div id="exercises-43" class="section level3" number="13.7.5">
<h3><span class="header-section-number">13.7.5</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Explain the differences in dispatch below:</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="s3.html#cb594-1" aria-hidden="true" tabindex="-1"></a>length.integer <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">10</span></span>
<span id="cb594-2"><a href="s3.html#cb594-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-3"><a href="s3.html#cb594-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb594-4"><a href="s3.html#cb594-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x1)</span>
<span id="cb594-5"><a href="s3.html#cb594-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;integer&quot;</span></span>
<span id="cb594-6"><a href="s3.html#cb594-6" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">length</span>(x1))</span>
<span id="cb594-7"><a href="s3.html#cb594-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  * length.integer</span></span>
<span id="cb594-8"><a href="s3.html#cb594-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    length.numeric</span></span>
<span id="cb594-9"><a href="s3.html#cb594-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    length.default</span></span>
<span id="cb594-10"><a href="s3.html#cb594-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; length (internal)</span></span>
<span id="cb594-11"><a href="s3.html#cb594-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-12"><a href="s3.html#cb594-12" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">structure</span>(x1, <span class="at">class =</span> <span class="st">&quot;integer&quot;</span>)</span>
<span id="cb594-13"><a href="s3.html#cb594-13" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x2)</span>
<span id="cb594-14"><a href="s3.html#cb594-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;integer&quot;</span></span>
<span id="cb594-15"><a href="s3.html#cb594-15" aria-hidden="true" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">length</span>(x2))</span>
<span id="cb594-16"><a href="s3.html#cb594-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =&gt; length.integer</span></span>
<span id="cb594-17"><a href="s3.html#cb594-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    length.default</span></span>
<span id="cb594-18"><a href="s3.html#cb594-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  * length (internal)</span></span></code></pre></div></li>
<li><p>What classes have a method for the <code>Math</code> group generic in base R? Read
the source code. How do the methods work?</p></li>
<li><p><code>Math.difftime()</code> is more complicated than I described. Why?</p></li>
</ol>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="68">
<li id="fn68"><p>The exceptions are methods found in the base package, like <code>t.data.frame</code>, and methods that you’ve created.<a href="s3.html#fnref68" class="footnote-back">↩︎</a></p></li>
<li id="fn69"><p>Recent versions of R have <code>.Date()</code>, <code>.difftime()</code>, <code>.POSIXct()</code>, and <code>.POSIXlt()</code> constructors but they are internal, not well documented, and do not follow the principles that I recommend.<a href="s3.html#fnref69" class="footnote-back">↩︎</a></p></li>
<li id="fn70"><p>This helper is not efficient: behind the scenes <code>ISODatetime()</code> works by pasting the components into a string and then using <code>strptime()</code>. A more efficient equivalent is available in <code>lubridate::make_datetime()</code>.<a href="s3.html#fnref70" class="footnote-back">↩︎</a></p></li>
<li id="fn71"><p>The exception is internal generics, which are implemented in C, and are the topic of Section <a href="s3.html#internal-generics">13.7.2</a>.<a href="s3.html#fnref71" class="footnote-back">↩︎</a></p></li>
<li id="fn72"><p>See <a href="https://github.com/hadley/ellipsis" class="uri">https://github.com/hadley/ellipsis</a> for an experimental way of warning when methods fail to use all the arguments in <code>...</code>, providing a potential resolution of this issue.<a href="s3.html#fnref72" class="footnote-back">↩︎</a></p></li>
<li id="fn73"><p>You can also build an object on top of a pairlist, but I have yet to find a good reason to do so.<a href="s3.html#fnref73" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="base-types.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/adv-r/edit/master/S3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
